<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Directory Synchronization - MockForge Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="A comprehensive mocking framework for APIs, gRPC, and WebSockets">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MockForge Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/SaaSy-Solutions/mockforge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/SaaSy-Solutions/mockforge/edit/main/src/user-guide/sync.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="directory-synchronization"><a class="header" href="#directory-synchronization">Directory Synchronization</a></h1>
<p>MockForgeâ€™s sync daemon enables automatic synchronization between workspace files and MockForgeâ€™s internal storage, allowing you to work with your mock API definitions as files and keep them in version control.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The sync daemon monitors a directory for <code>.yaml</code> and <code>.yml</code> files and automatically imports them into MockForge workspaces. This enables:</p>
<ul>
<li><strong>File-based workflows</strong>: Edit workspace files with your favorite text editor</li>
<li><strong>Version control</strong>: Keep workspace definitions in Git</li>
<li><strong>Team collaboration</strong>: Share workspaces via Git repositories</li>
<li><strong>Automated workflows</strong>: CI/CD integration and automated deployment</li>
<li><strong>Real-time feedback</strong>: See exactly whatâ€™s being synced as it happens</li>
</ul>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How It Works</a></h2>
<p>The sync daemon provides bidirectional synchronization:</p>
<ol>
<li><strong>Monitors Directory</strong>: Watches for file changes in the specified workspace directory</li>
<li><strong>Detects Changes</strong>: Identifies created, modified, and deleted <code>.yaml</code>/<code>.yml</code> files</li>
<li><strong>Imports Automatically</strong>: Parses and imports valid MockRequest files into workspaces</li>
<li><strong>Provides Feedback</strong>: Shows clear, real-time output of all sync operations</li>
</ol>
<h3 id="what-gets-synced"><a class="header" href="#what-gets-synced">What Gets Synced</a></h3>
<ul>
<li><strong>File Types</strong>: Only <code>.yaml</code> and <code>.yml</code> files</li>
<li><strong>File Format</strong>: Files must be valid MockRequest YAML</li>
<li><strong>Subdirectories</strong>: Monitors all subdirectories recursively</li>
<li><strong>Exclusions</strong>: Skips hidden files (starting with <code>.</code>)</li>
</ul>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<h3 id="starting-the-sync-daemon"><a class="header" href="#starting-the-sync-daemon">Starting the Sync Daemon</a></h3>
<p>Use the CLI to start the sync daemon:</p>
<pre><code class="language-bash"># Basic usage
mockforge sync --workspace-dir ./my-workspace

# Short form
mockforge sync -w ./my-workspace

# With custom configuration
mockforge sync --workspace-dir ./workspace --config sync-config.yaml
</code></pre>
<h3 id="what-youll-see"><a class="header" href="#what-youll-see">What Youâ€™ll See</a></h3>
<p>When you start the sync daemon:</p>
<pre><code>ğŸ”„ Starting MockForge Sync Daemon...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ Workspace directory: ./my-workspace

â„¹ï¸  What the sync daemon does:
   â€¢ Monitors the workspace directory for .yaml/.yml file changes
   â€¢ Automatically imports new or modified request files
   â€¢ Syncs changes bidirectionally between files and workspace
   â€¢ Skips hidden files (starting with .)

ğŸ” Monitoring for file changes...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Sync daemon started successfully!
ğŸ’¡ Press Ctrl+C to stop
</code></pre>
<h3 id="real-time-feedback"><a class="header" href="#real-time-feedback">Real-time Feedback</a></h3>
<p>As files change, youâ€™ll see detailed output:</p>
<pre><code>ğŸ”„ Detected 1 file change in workspace 'default'
  â• Created: new-endpoint.yaml
     âœ… Successfully imported

ğŸ”„ Detected 2 file changes in workspace 'default'
  ğŸ“ Modified: user-api.yaml
     âœ… Successfully updated
  ğŸ—‘ï¸  Deleted: old-endpoint.yaml
     â„¹ï¸  Auto-deletion from workspace is disabled
</code></pre>
<h2 id="directory-organization"><a class="header" href="#directory-organization">Directory Organization</a></h2>
<p>You can organize your workspace files however you like. The sync daemon monitors all subdirectories recursively:</p>
<pre><code>my-workspace/
â”œâ”€â”€ api-v1/
â”‚   â”œâ”€â”€ users.yaml
â”‚   â”œâ”€â”€ products.yaml
â”‚   â””â”€â”€ orders.yaml
â”œâ”€â”€ api-v2/
â”‚   â”œâ”€â”€ users.yaml
â”‚   â””â”€â”€ graphql.yaml
â”œâ”€â”€ internal/
â”‚   â””â”€â”€ admin.yaml
â””â”€â”€ shared/
    â””â”€â”€ auth.yaml
</code></pre>
<p>All <code>.yaml</code> and <code>.yml</code> files will be monitored and imported automatically.</p>
<h2 id="file-format"><a class="header" href="#file-format">File Format</a></h2>
<p>Each file should contain a valid MockRequest in YAML format:</p>
<pre><code class="language-yaml">id: "get-users"
name: "Get Users"
method: "GET"
path: "/api/users"
headers:
  Content-Type: "application/json"
response_status: 200
response_body: |
  [
    {"id": 1, "name": "Alice"},
    {"id": 2, "name": "Bob"}
  ]
</code></pre>
<h2 id="usage-examples"><a class="header" href="#usage-examples">Usage Examples</a></h2>
<h3 id="git-integration"><a class="header" href="#git-integration">Git Integration</a></h3>
<p>Keep your workspaces in version control:</p>
<pre><code class="language-bash"># 1. Create a Git repository for your workspaces
mkdir api-mocks
cd api-mocks
git init

# 2. Start the sync daemon
mockforge sync --workspace-dir .

# 3. Create or edit workspace files
vim user-endpoints.yaml

# 4. Commit and push changes
git add .
git commit -m "Add user endpoints"
git push origin main

# 5. Team members can pull changes
# The sync daemon will automatically import updates
</code></pre>
<h3 id="development-workflow"><a class="header" href="#development-workflow">Development Workflow</a></h3>
<p>Use the sync daemon during active development:</p>
<pre><code class="language-bash"># Terminal 1: Start sync daemon
mockforge sync --workspace-dir ./workspaces

# Terminal 2: Edit files
vim ./workspaces/new-feature.yaml

# Changes are automatically imported
# You'll see real-time feedback in Terminal 1
</code></pre>
<h3 id="cicd-integration"><a class="header" href="#cicd-integration">CI/CD Integration</a></h3>
<p>Automate workspace deployment:</p>
<pre><code class="language-bash">#!/bin/bash
# deploy-mocks.sh

# Pull latest workspace definitions from Git
git pull origin main

# Start sync daemon in background
mockforge sync --workspace-dir ./workspaces &amp;
SYNC_PID=$!

# Wait for initial sync
sleep 5

# Start MockForge server
mockforge serve --config mockforge.yaml

# Cleanup on exit
trap "kill $SYNC_PID" EXIT
</code></pre>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="1-use-version-control"><a class="header" href="#1-use-version-control">1. Use Version Control</a></h3>
<p>Keep workspace files in Git for team collaboration:</p>
<pre><code class="language-bash"># Create a .gitignore to exclude temporary files
echo ".DS_Store" &gt;&gt; .gitignore
echo "*.swp" &gt;&gt; .gitignore
echo "*.tmp" &gt;&gt; .gitignore

# Commit workspace definitions
git add *.yaml
git commit -m "Add workspace definitions"
</code></pre>
<h3 id="2-organize-files-logically"><a class="header" href="#2-organize-files-logically">2. Organize Files Logically</a></h3>
<p>Structure your workspace files for clarity:</p>
<pre><code>workspaces/
â”œâ”€â”€ production/         # Production endpoints
â”‚   â”œâ”€â”€ users-api.yaml
â”‚   â””â”€â”€ orders-api.yaml
â”œâ”€â”€ staging/           # Staging endpoints
â”‚   â””â”€â”€ beta-features.yaml
â””â”€â”€ development/       # Development/experimental
    â””â”€â”€ new-feature.yaml
</code></pre>
<h3 id="3-use-descriptive-filenames"><a class="header" href="#3-use-descriptive-filenames">3. Use Descriptive Filenames</a></h3>
<p>Name files based on what they contain:</p>
<pre><code>âœ… Good:
   - user-authentication.yaml
   - product-catalog-api.yaml
   - payment-processing.yaml

âŒ Bad:
   - endpoint1.yaml
   - test.yaml
   - temp.yaml
</code></pre>
<h3 id="4-keep-sync-daemon-running"><a class="header" href="#4-keep-sync-daemon-running">4. Keep Sync Daemon Running</a></h3>
<p>Run the sync daemon continuously during development:</p>
<pre><code class="language-bash"># Use a terminal multiplexer like tmux
tmux new -s mockforge-sync
mockforge sync --workspace-dir ./workspaces

# Detach with Ctrl+B then D
# Reattach with: tmux attach -t mockforge-sync
</code></pre>
<h3 id="5-monitor-sync-output"><a class="header" href="#5-monitor-sync-output">5. Monitor Sync Output</a></h3>
<p>Pay attention to the sync daemonâ€™s output:</p>
<ul>
<li>âœ… <strong>Green checkmarks</strong>: Files imported successfully</li>
<li>âš ï¸ <strong>Warning icons</strong>: Import failed, check file format</li>
<li>ğŸ”„ <strong>Change notifications</strong>: Shows whatâ€™s being synced</li>
<li>âŒ <strong>Error messages</strong>: Indicate issues that need fixing</li>
</ul>
<h3 id="6-handle-errors-promptly"><a class="header" href="#6-handle-errors-promptly">6. Handle Errors Promptly</a></h3>
<p>When you see errors, fix them immediately:</p>
<pre><code>âŒ Detected error:
  ğŸ“ Modified: broken-endpoint.yaml
     âš ï¸  Failed to import: File is not a recognized format

Action: Check the file syntax and fix YAML formatting
</code></pre>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="files-not-being-imported"><a class="header" href="#files-not-being-imported">Files Not Being Imported</a></h3>
<p><strong>Check file extension:</strong></p>
<pre><code class="language-bash"># Only .yaml and .yml files are monitored
ls -la workspaces/
# Ensure files end with .yaml or .yml
</code></pre>
<p><strong>Verify file format:</strong></p>
<pre><code class="language-bash"># Files must be valid MockRequest YAML
cat workspaces/my-file.yaml
# Check for proper YAML syntax and required fields
</code></pre>
<p><strong>Check for hidden files:</strong></p>
<pre><code class="language-bash"># Hidden files (starting with .) are ignored
# Rename: .hidden.yaml â†’ visible.yaml
mv .hidden.yaml visible.yaml
</code></pre>
<h3 id="permission-errors"><a class="header" href="#permission-errors">Permission Errors</a></h3>
<pre><code class="language-bash"># Ensure MockForge can read the directory
chmod 755 workspaces/
chmod 644 workspaces/*.yaml

# Check ownership
ls -la workspaces/
</code></pre>
<h3 id="changes-not-detected"><a class="header" href="#changes-not-detected">Changes Not Detected</a></h3>
<p><strong>Verify sync daemon is running:</strong></p>
<pre><code class="language-bash"># Check if the process is still active
ps aux | grep "mockforge sync"
</code></pre>
<p><strong>Check filesystem notifications:</strong></p>
<pre><code class="language-bash"># Some network filesystems don't support notifications
# Try editing locally instead of over NFS/SMB
</code></pre>
<p><strong>Restart sync daemon:</strong></p>
<pre><code class="language-bash"># Stop with Ctrl+C, then restart
mockforge sync --workspace-dir ./workspaces
</code></pre>
<h3 id="yaml-syntax-errors"><a class="header" href="#yaml-syntax-errors">YAML Syntax Errors</a></h3>
<p>When files fail to import due to syntax errors:</p>
<pre><code class="language-bash"># Use a YAML validator
yamllint workspaces/problematic-file.yaml

# Common issues:
# - Incorrect indentation
# - Missing quotes around special characters
# - Invalid escape sequences
</code></pre>
<h3 id="debug-logging"><a class="header" href="#debug-logging">Debug Logging</a></h3>
<p>Enable detailed logging to see whatâ€™s happening:</p>
<pre><code class="language-bash"># Enable debug logs for sync watcher
RUST_LOG=mockforge_core::sync_watcher=debug mockforge sync --workspace-dir ./workspaces

# Enable trace-level logs for maximum detail
RUST_LOG=mockforge_core::sync_watcher=trace mockforge sync --workspace-dir ./workspaces

# Log to a file
RUST_LOG=mockforge_core::sync_watcher=debug mockforge sync --workspace-dir ./workspaces 2&gt;&amp;1 | tee sync.log
</code></pre>
<h3 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h3>
<p>If youâ€™re still having issues:</p>
<ol>
<li>Check the sync daemon output for error messages</li>
<li>Enable debug logging to see detailed information</li>
<li>Verify file format matches MockRequest YAML structure</li>
<li>Check file permissions and ownership</li>
<li>Try with a minimal test file to isolate the issue</li>
</ol>
<p>Example minimal test file:</p>
<pre><code class="language-yaml"># test-endpoint.yaml
id: "test"
name: "Test Endpoint"
method: "GET"
path: "/test"
response_status: 200
response_body: '{"status": "ok"}'
</code></pre>
<p>Save this file in your workspace directory and verify it gets imported successfully.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../user-guide/security.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../user-guide/admin-ui.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../user-guide/security.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../user-guide/admin-ui.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../custom.js"></script>



    </div>
    </body>
</html>
