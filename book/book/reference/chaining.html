<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Request Chaining - MockForge Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="A comprehensive mocking framework for APIs, gRPC, and WebSockets">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MockForge Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/SaaSy-Solutions/mockforge" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/SaaSy-Solutions/mockforge/edit/main/src/reference/chaining.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="request-chaining"><a class="header" href="#request-chaining">Request Chaining</a></h1>
<p>MockForge supports request chaining, which allows you to create complex workflows where requests can depend on responses from previous requests in the chain. This is particularly useful for testing API workflows that require authentication, data flow between endpoints, or multi-step operations.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Request chaining enables you to:</p>
<ul>
<li>Execute requests in a predefined sequence with dependencies</li>
<li>Reference data from previous responses using template variables</li>
<li>Extract and store specific values from responses for reuse</li>
<li>Validate response status codes and content</li>
<li>Implement parallel execution for independent requests</li>
<li>Handle complex authentication and authorization flows</li>
</ul>
<h2 id="chain-definition"><a class="header" href="#chain-definition">Chain Definition</a></h2>
<p>Chains are defined using YAML or JSON configuration files with the following structure:</p>
<pre><code class="language-yaml">id: my-chain
name: My Chain
description: A description of what this chain does
config:
  enabled: true
  maxChainLength: 20
  globalTimeoutSecs: 300
  enableParallelExecution: false
links:
  # Define your requests here
  - request:
      id: step1
      method: POST
      url: https://api.example.com/auth/login
      headers:
        Content-Type: application/json
      body:
        username: "testuser"
        password: "password123"
    extract:
      token: body.access_token
    storeAs: login_response
    dependsOn: []
variables:
  base_url: https://api.example.com
tags:
  - authentication
  - workflow
</code></pre>
<h2 id="chain-configuration"><a class="header" href="#chain-configuration">Chain Configuration</a></h2>
<p>The <code>config</code> section controls how the chain behaves:</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody>
<tr><td><code>enabled</code></td><td>boolean</td><td><code>false</code></td><td>Whether this chain is enabled</td></tr>
<tr><td><code>maxChainLength</code></td><td>integer</td><td><code>20</code></td><td>Maximum number of requests in the chain</td></tr>
<tr><td><code>globalTimeoutSecs</code></td><td>integer</td><td><code>300</code></td><td>Total timeout for chain execution</td></tr>
<tr><td><code>enableParallelExecution</code></td><td>boolean</td><td><code>false</code></td><td>Enable parallel execution of independent requests</td></tr>
</tbody></table>
</div>
<h2 id="request-links"><a class="header" href="#request-links">Request Links</a></h2>
<p>Each link in the chain defines a single HTTP request and its behavior:</p>
<h3 id="request-definition"><a class="header" href="#request-definition">Request Definition</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td><code>id</code></td><td>string</td><td>Yes</td><td>Unique identifier for this request</td></tr>
<tr><td><code>method</code></td><td>string</td><td>Yes</td><td>HTTP method (GET, POST, PUT, DELETE, etc.)</td></tr>
<tr><td><code>url</code></td><td>string</td><td>Yes</td><td>Request URL (supports template variables)</td></tr>
<tr><td><code>headers</code></td><td>object</td><td>No</td><td>Request headers</td></tr>
<tr><td><code>body</code></td><td>any</td><td>No</td><td>Request body (supports template variables)</td></tr>
<tr><td><code>dependsOn</code></td><td>array</td><td>No</td><td>List of request IDs this request depends on</td></tr>
<tr><td><code>timeoutSecs</code></td><td>number</td><td>No</td><td>Individual request timeout</td></tr>
<tr><td><code>expectedStatus</code></td><td>array</td><td>No</td><td>Expected status codes for validation</td></tr>
</tbody></table>
</div>
<h3 id="response-processing"><a class="header" href="#response-processing">Response Processing</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td><code>extract</code></td><td>object</td><td>No</td><td>Extract values from response into variables</td></tr>
<tr><td><code>storeAs</code></td><td>string</td><td>No</td><td>Store entire response with this name</td></tr>
</tbody></table>
</div>
<h2 id="template-variables"><a class="header" href="#template-variables">Template Variables</a></h2>
<p>Chain requests support powerful templating that can reference:</p>
<h3 id="previous-response-data"><a class="header" href="#previous-response-data">Previous Response Data</a></h3>
<p>Use <code>{{chain.&lt;response_name&gt;.&lt;path&gt;}}</code> to reference data from previous responses:</p>
<pre><code class="language-yaml">url: https://api.example.com/users/{{chain.login_response.body.user_id}}/posts
headers:
  Authorization: "Bearer {{chain.auth_response.body.access_token}}"
</code></pre>
<h3 id="variable-extraction"><a class="header" href="#variable-extraction">Variable Extraction</a></h3>
<p>Extract values from responses into reusable variables:</p>
<pre><code class="language-yaml">extract:
  user_id: body.user.id
  token: body.access_token
storeAs: user_response
</code></pre>
<h3 id="built-in-template-functions"><a class="header" href="#built-in-template-functions">Built-in Template Functions</a></h3>
<p>All standard MockForge templating functions are available:</p>
<ul>
<li><code>{{uuid}}</code> - Random UUID</li>
<li><code>{{faker.email}}</code> - Fake email address</li>
<li><code>{{faker.name}}</code> - Fake name</li>
<li><code>{{rand.int}}</code> - Random integer</li>
<li><code>{{now}}</code> - Current timestamp</li>
</ul>
<h2 id="advanced-features"><a class="header" href="#advanced-features">Advanced Features</a></h2>
<h3 id="dependency-resolution"><a class="header" href="#dependency-resolution">Dependency Resolution</a></h3>
<p>Requests can depend on other requests using the <code>dependsOn</code> field. MockForge automatically resolves dependencies using topological sorting:</p>
<pre><code class="language-yaml">links:
  - request:
      id: login
      method: POST
      url: https://api.example.com/auth/login
      body:
        username: "user"
        password: "pass"
    storeAs: auth

  - request:
      id: get_profile
      method: GET
      url: https://api.example.com/user/profile
      headers:
        Authorization: "Bearer {{chain.auth.body.token}}"
    dependsOn:
      - login
</code></pre>
<h3 id="parallel-execution"><a class="header" href="#parallel-execution">Parallel Execution</a></h3>
<p>Enable <code>enableParallelExecution: true</code> to allow independent requests to run simultaneously:</p>
<pre><code class="language-yaml">config:
  enableParallelExecution: true
links:
  - request:
      id: get_profile
      method: GET
      url: https://api.example.com/profile
    dependsOn:
      - login

  - request:
      id: get_preferences
      method: GET
      url: https://api.example.com/preferences
    dependsOn:
      - login
  # These two requests will run in parallel
</code></pre>
<h3 id="response-validation"><a class="header" href="#response-validation">Response Validation</a></h3>
<p>Validate response status codes and content:</p>
<pre><code class="language-yaml">links:
  - request:
      id: create_user
      method: POST
      url: https://api.example.com/users
      body:
        name: "John Doe"
    expectedStatus: [201, 202]  # Expect 201 or 202 status codes
</code></pre>
<h2 id="json-path-support"><a class="header" href="#json-path-support">JSON Path Support</a></h2>
<p>Chain templating supports JSON path syntax for accessing nested data:</p>
<h3 id="simple-properties"><a class="header" href="#simple-properties">Simple Properties</a></h3>
<pre><code class="language-yaml">extract:
  user_id: body.id
  name: body.profile.name
</code></pre>
<h3 id="array-access"><a class="header" href="#array-access">Array Access</a></h3>
<pre><code class="language-yaml">extract:
  first_user: body.users.[0].name
  user_count: body.users.[*]  # Get array length
</code></pre>
<h3 id="complex-nesting"><a class="header" href="#complex-nesting">Complex Nesting</a></h3>
<pre><code class="language-yaml">url: https://api.example.com/users/{{chain.login_response.body.user.id}}/projects/{{chain.project_response.body.data.[0].id}}
</code></pre>
<h2 id="response-function-new-ui-feature"><a class="header" href="#response-function-new-ui-feature">Response Function (New UI Feature)</a></h2>
<p>MockForge also supports a <code>response()</code> function for use in the Admin UI and other editing contexts:</p>
<h3 id="syntax"><a class="header" href="#syntax">Syntax</a></h3>
<pre><code class="language-javascript">response('request_name', 'json_path')
</code></pre>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<pre><code class="language-javascript">// Simple usage
response('login', 'body.user_id')

// Complex JSON path
response('user_profile', 'body.data.employee.name')

// Environment variable usage
let userId = response('login', 'body.user_id');
let updateUrl = `/users/${userId}/profile`;
</code></pre>
<h3 id="ui-integration"><a class="header" href="#ui-integration">UI Integration</a></h3>
<ol>
<li><strong>Autocomplete</strong>: Type <code>response(</code> in any input field in the UI and use Ctrl+Space for autocomplete</li>
<li><strong>Configuration Dialog</strong>: Click the blue template tag next to the function to open the configuration dialog</li>
<li><strong>Request Selection</strong>: Choose from available requests in the current chain</li>
<li><strong>Path Specification</strong>: Enter the JSONPath to extract the desired value</li>
</ol>
<h2 id="prepost-request-scripting"><a class="header" href="#prepost-request-scripting">Pre/Post Request Scripting</a></h2>
<p>MockForge supports JavaScript scripting for complex request processing and data manipulation in request chains.</p>
<h3 id="enable-scripting"><a class="header" href="#enable-scripting">Enable Scripting</a></h3>
<p>Add scripting configuration to any request in your chain:</p>
<pre><code class="language-yaml">links:
  - request:
      id: process_data
      method: POST
      url: https://api.example.com/process
      scripting:
        pre_script: |
          // Execute before request
          console.log('Processing request with mockforge context');
          console.log('Request URL:', mockforge.request.url);

          if (mockforge.variables.skip_processing) {
            request.body.skip_processing = true;
          }
        post_script: |
          // Execute after request
          console.log('Request completed in', mockforge.response.duration_ms, 'ms');

          if (mockforge.response.status === 429) {
            throw new Error('Rate limited - retry needed');
          }

          // Store custom data for next request
          setVariable('processed_user_id', mockforge.response.body.user_id);
        runtime: javascript
        timeout_ms: 5000
</code></pre>
<h3 id="pre-scripts"><a class="header" href="#pre-scripts">Pre-Scripts</a></h3>
<p>Executed before the HTTP request:</p>
<pre><code class="language-javascript">// Available context in mockforge object:
mockforge.request     // Current request (id, method, url, headers)
mockforge.chain       // Previous responses: mockforge.chain.login.body.user_id
mockforge.variables   // Chain variables
mockforge.env         // Environment variables

// Direct access to functions:
console.log('Starting request processing');

// Modify request before it goes out
if (mockforge.variables.enable_debug) {
  request.headers['X-Debug'] = 'true';
  request.body.debug_mode = true;
}

// Set variables for this request
setVariable('request_start_time', Date.now());

// Example: Add authentication from previous response
request.headers['Authorization'] = 'Bearer ' + mockforge.chain.login.body.token;
</code></pre>
<h3 id="post-scripts"><a class="header" href="#post-scripts">Post-Scripts</a></h3>
<p>Executed after the HTTP response:</p>
<pre><code class="language-javascript">// Available context in mockforge object:
mockforge.response    // Current response (status, headers, body, duration_ms)
mockforge.request     // Original request
mockforge.chain       // Previous responses
mockforge.variables   // Chain variables
mockforge.env         // Environment variables

// Example: Validate response and extract data
if (mockforge.response.status !== 200) {
  throw new Error('Request failed with status ' + mockforge.response.status);
}

// Extract and store data for next requests
setVariable('user_profile', mockforge.response.body);
setVariable('session_cookie', mockforge.response.headers['Set-Cookie']);

// Example: Transform response data
if (mockforge.response.body &amp;&amp; mockforge.response.body.user) {
  mockforge.response.body.processed_user = {
    fullName: mockforge.response.body.user.first_name + ' ' + mockforge.response.body.user.last_name,
    age: mockforge.response.body.user.age,
    isActive: mockforge.response.body.user.status === 'active'
  };
}
</code></pre>
<h3 id="built-in-functions"><a class="header" href="#built-in-functions">Built-in Functions</a></h3>
<h4 id="logging-and-diagnostics"><a class="header" href="#logging-and-diagnostics">Logging and Diagnostics</a></h4>
<pre><code class="language-javascript">console.log('Debug message:', mockforge.request.url);
console.warn('Warning:', mockforge.response.status);
console.error('Error occurred');
</code></pre>
<h4 id="variable-management"><a class="header" href="#variable-management">Variable Management</a></h4>
<pre><code class="language-javascript">// Set a variable for use in next requests
setVariable('api_token', mockforge.response.body.token);

// Access environment variables
const configUrl = mockforge.env['API_CONFIG_URL'];
</code></pre>
<h4 id="data-validation"><a class="header" href="#data-validation">Data Validation</a></h4>
<pre><code class="language-javascript">// Simple assertions
assert(mockforge.response.status === 200, 'Expected status 200');

// Complex validation
if (!mockforge.response.body || !mockforge.response.body.items) {
  throw new Error('Response missing required "items" field');
}

if (mockforge.response.body.items.length === 0) {
  console.warn('Response contains empty items array');
}
</code></pre>
<h3 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h3>
<p>Scripts can throw errors to fail the chain:</p>
<pre><code class="language-javascript">if (mockforge.response.status &gt;= 400) {
  throw new Error('HTTP ' + mockforge.response.status + ': ' + mockforge.response.body.error);
}

if (mockforge.response.duration_ms &gt; 30000) {
  throw new Error('Request took too long: ' + mockforge.response.duration_ms + 'ms');
}
</code></pre>
<h3 id="security-and-isolation"><a class="header" href="#security-and-isolation">Security and Isolation</a></h3>
<ul>
<li><strong>Timeout Protection</strong>: Scripts are limited by <code>timeout_ms</code> (default: 5 seconds)</li>
<li><strong>Sandboxing</strong>: Scripts run in isolated JavaScript contexts</li>
<li><strong>Resource Limits</strong>: CPU and memory usage is monitored and limited</li>
<li><strong>Network Restrictions</strong>: Scripts cannot make outbound network calls</li>
<li><strong>File System Access</strong>: Read-only file access through <code>fs.readFile()</code> function</li>
</ul>
<h3 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h3>
<ol>
<li><strong>Keep Scripts Simple</strong>: Break complex logic into smaller, focused scripts</li>
<li><strong>Validate Inputs</strong>: Always check that expected data exists before processing</li>
<li><strong>Set Appropriate Timeouts</strong>: Use shorter timeouts for simple scripts</li>
<li><strong>Use Environment Variables</strong>: Store configuration in environment variables</li>
<li><strong>Error Handling</strong>: Always check for error conditions and fail fast when needed</li>
<li><strong>Documentation</strong>: Comment complex business logic in your scripts</li>
<li><strong>Testing</strong>: Test scripts with various response scenarios</li>
</ol>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<p>For multiple uses of the same response value, store it in an environment variable:</p>
<pre><code class="language-javascript">// In environment variables
RESPONSE_USER_ID = response('login', 'body.user_id')

// Then use in multiple places
let url1 = `/users/${RESPONSE_USER_ID}`;
let url2 = `/profile/${RESPONSE_USER_ID}`;
</code></pre>
<h3 id="benefits-over-traditional-templates"><a class="header" href="#benefits-over-traditional-templates">Benefits Over Traditional Templates</a></h3>
<ul>
<li><strong>Cleaner Syntax</strong>: More readable than <code>{{chain.request_name.body.path}}</code></li>
<li><strong>Type Safety</strong>: JSONPath validation in the UI</li>
<li><strong>Better UX</strong>: Visual configuration through dialogs</li>
<li><strong>Autocomplete</strong>: Intelligent suggestions for request names and paths</li>
</ul>
<h2 id="error-handling-1"><a class="header" href="#error-handling-1">Error Handling</a></h2>
<p>Chains provide comprehensive error handling:</p>
<ul>
<li><strong>Dependency errors</strong>: Missing or invalid dependencies</li>
<li><strong>Circular dependencies</strong>: Automatic detection and prevention</li>
<li><strong>Timeout errors</strong>: Individual and global timeouts</li>
<li><strong>Status validation</strong>: Expected status code validation</li>
<li><strong>Network errors</strong>: Connection and HTTP errors</li>
</ul>
<h2 id="chain-management"><a class="header" href="#chain-management">Chain Management</a></h2>
<p>Chains can be managed programmatically or via configuration files:</p>
<h3 id="loading-chains"><a class="header" href="#loading-chains">Loading Chains</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use mockforge_core::RequestChainRegistry;

let registry = RequestChainRegistry::new(chain_config);
// Load from YAML
registry.register_from_yaml(yaml_content).await?;
// Load from JSON
registry.register_from_json(json_content).await?;
<span class="boring">}</span></code></pre></pre>
<h3 id="executing-chains"><a class="header" href="#executing-chains">Executing Chains</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use mockforge_core::ChainExecutionEngine;

let engine = ChainExecutionEngine::new(registry, config);
// Execute a chain
let result = engine.execute_chain("my-chain").await?;
println!("Chain executed in {}ms", result.total_duration_ms);
<span class="boring">}</span></code></pre></pre>
<h2 id="complete-example"><a class="header" href="#complete-example">Complete Example</a></h2>
<p>See the provided examples in the <code>examples/</code> directory:</p>
<ul>
<li><code>examples/chain-example.yaml</code> - Comprehensive user management workflow</li>
<li><code>examples/simple-chain.json</code> - Simple authentication chain</li>
</ul>
<h2 id="working-with-large-values"><a class="header" href="#working-with-large-values">Working With Large Values</a></h2>
<p>MockForge provides several strategies to handle large values efficiently without affecting performance or crashing the user interface. The system automatically hides large text values by default, but extremely large values can still impact performance.</p>
<h3 id="file-system-template-functions"><a class="header" href="#file-system-template-functions">File System Template Functions</a></h3>
<p>MockForge supports the <code>fs.readFile()</code> template function for reading file contents directly into templates. This is particularly useful for including large text content within structured data.</p>
<p><strong>Syntax:</strong></p>
<pre><code class="language-yaml">{{fs.readFile "path/to/file.txt"}}
{{fs.readFile('path/to/file.txt')}}
</code></pre>
<p><strong>Example usage in request chaining:</strong></p>
<pre><code class="language-yaml">links:
  - request:
      id: upload_large_data
      method: POST
      url: https://api.example.com/upload
      headers:
        Content-Type: application/json
      body:
        metadata:
          filename: "large_document.txt"
          size: 1048576
        content: "{{fs.readFile('/path/to/large/file.txt')}}"
</code></pre>
<p><strong>Error handling:</strong></p>
<ul>
<li>If the file doesn’t exist: <code>&lt;fs.readFile error: No such file or directory (os error 2)&gt;</code></li>
<li>If the path is empty: <code>&lt;fs.readFile: empty path&gt;</code></li>
</ul>
<h3 id="binary-file-request-bodies"><a class="header" href="#binary-file-request-bodies">Binary File Request Bodies</a></h3>
<p>For truly large binary files (images, videos, documents), MockForge supports binary file request bodies that reference files on disk rather than loading them into memory.</p>
<p><strong>YAML Configuration:</strong></p>
<pre><code class="language-yaml">links:
  - request:
      id: upload_image
      method: POST
      url: https://api.example.com/upload
      body:
        type: binary_file
        data:
          path: "/path/to/image.jpg"
          content_type: "image/jpeg"
</code></pre>
<p><strong>JSON Configuration:</strong></p>
<pre><code class="language-json">{
  "id": "upload_image",
  "method": "POST",
  "url": "https://api.example.com/upload",
  "body": {
    "type": "binary_file",
    "data": {
      "path": "/path/to/image.jpg",
      "content_type": "image/jpeg"
    }
  }
}
</code></pre>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Path templating</strong>: File paths support template expansion (e.g., <code>"{{chain.previous_response.body.file_path}}"</code>)</li>
<li><strong>Content type</strong>: Optional content-type header (defaults to none for binary files)</li>
<li><strong>Memory efficient</strong>: Files are read only when the request is executed</li>
<li><strong>Error handling</strong>: Clear error messages for missing files</li>
</ul>
<h3 id="performance-best-practices"><a class="header" href="#performance-best-practices">Performance Best Practices</a></h3>
<ol>
<li><strong>Use binary_file for large binary content</strong> (images, videos, large documents)</li>
<li><strong>Use fs.readFile for large text content</strong> within structured JSON/XML bodies</li>
<li><strong>Template file paths</strong> to make configurations dynamic</li>
<li><strong>Validate file paths</strong> before running chains to avoid runtime errors</li>
<li><strong>Consider file size limits</strong> based on your system’s memory constraints</li>
</ol>
<h2 id="best-practices-1"><a class="header" href="#best-practices-1">Best Practices</a></h2>
<ol>
<li><strong>Keep chains focused</strong>: Each chain should have a single, clear purpose</li>
<li><strong>Use meaningful IDs</strong>: Choose descriptive names for requests and chains</li>
<li><strong>Handle dependencies carefully</strong>: Ensure dependency chains are logical and avoid cycles</li>
<li><strong>Validate responses</strong>: Use <code>expectedStatus</code> and <code>extract</code> for critical paths</li>
<li><strong>Use parallel execution</strong>: Enable for independent requests to improve performance</li>
<li><strong>Template effectively</strong>: Leverage chain context variables for dynamic content</li>
<li><strong>Error handling</strong>: Plan for failure scenarios in your chains</li>
<li><strong>Handle large values efficiently</strong>: Use <code>fs.readFile()</code> for large text content and <code>binary_file</code> request bodies for large binary files to maintain performance</li>
</ol>
<h2 id="limitations"><a class="header" href="#limitations">Limitations</a></h2>
<ul>
<li>Maximum chain length is configurable (default: 20 requests)</li>
<li>Global execution timeout applies to entire chain</li>
<li>Circular dependencies are automatically prevented</li>
<li>Parallel execution requires careful dependency management</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference/templating.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../reference/fixtures.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference/templating.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../reference/fixtures.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../custom.js"></script>



    </div>
    </body>
</html>
