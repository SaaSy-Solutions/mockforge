# Security Event Definitions

**Purpose:** Define all security events generated by MockForge
**Compliance:** SOC 2 CC4, ISO 27001 A.12.4

---

## Event Categories

### 1. Authentication Events

#### `auth.success`
**Description:** Successful authentication
**Severity:** Info
**Fields:**
- `user_id`: User identifier
- `username`: Username
- `auth_method`: Authentication method (jwt, oauth2, api_key, basic)
- `ip_address`: Client IP address
- `user_agent`: Client user agent
- `session_id`: Session identifier

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `auth.failure`
**Description:** Failed authentication attempt
**Severity:** Medium
**Fields:**
- `username`: Attempted username (if available)
- `auth_method`: Authentication method attempted
- `ip_address`: Client IP address
- `user_agent`: Client user agent
- `failure_reason`: Reason for failure
- `attempt_count`: Number of consecutive failures
- `lockout_triggered`: Whether account lockout was triggered

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `auth.token_expired`
**Description:** Token expiration
**Severity:** Low
**Fields:**
- `user_id`: User identifier
- `token_type`: Token type (jwt, oauth2)
- `ip_address`: Client IP address

#### `auth.token_revoked`
**Description:** Token revocation
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `token_type`: Token type
- `revoked_by`: User who revoked the token
- `reason`: Revocation reason

#### `auth.mfa_enabled`
**Description:** Multi-factor authentication enabled
**Severity:** Info
**Fields:**
- `user_id`: User identifier
- `mfa_method`: MFA method (totp, sms, email)

#### `auth.mfa_disabled`
**Description:** Multi-factor authentication disabled
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `disabled_by`: User who disabled MFA

#### `auth.password_changed`
**Description:** Password change
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `changed_by`: User who changed the password
- `ip_address`: IP address of change

#### `auth.password_reset`
**Description:** Password reset
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `reset_method`: Reset method (email, admin)
- `ip_address`: IP address of reset

---

### 2. Authorization Events

#### `authz.access_granted`
**Description:** Access granted
**Severity:** Info
**Fields:**
- `user_id`: User identifier
- `resource_type`: Type of resource accessed
- `resource_id`: Resource identifier
- `action`: Action performed
- `permissions`: Permissions used

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.4 (System Access Control)

#### `authz.access_denied`
**Description:** Access denied
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `resource_type`: Type of resource attempted
- `resource_id`: Resource identifier
- `action`: Action attempted
- `reason`: Reason for denial

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.4 (System Access Control)

#### `authz.privilege_escalation`
**Description:** Privilege escalation
**Severity:** High
**Fields:**
- `user_id`: User identifier
- `old_role`: Previous role
- `new_role`: New role
- `escalated_by`: User who performed escalation
- `ip_address`: IP address of escalation

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `authz.role_changed`
**Description:** Role change
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `old_role`: Previous role
- `new_role`: New role
- `changed_by`: User who changed the role
- `ip_address`: IP address of change

#### `authz.permission_changed`
**Description:** Permission change
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `resource_type`: Resource type
- `permissions_added`: Permissions added
- `permissions_removed`: Permissions removed
- `changed_by`: User who changed permissions

---

### 3. Access Management Events

#### `access.user_created`
**Description:** User account created
**Severity:** Info
**Fields:**
- `user_id`: New user identifier
- `username`: Username
- `email`: Email address
- `role`: Initial role
- `created_by`: User who created the account
- `ip_address`: IP address of creation

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `access.user_deleted`
**Description:** User account deleted
**Severity:** High
**Fields:**
- `user_id`: Deleted user identifier
- `username`: Username
- `deleted_by`: User who deleted the account
- `ip_address`: IP address of deletion
- `reason`: Deletion reason

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `access.user_suspended`
**Description:** User account suspended
**Severity:** Medium
**Fields:**
- `user_id`: Suspended user identifier
- `suspended_by`: User who suspended the account
- `reason`: Suspension reason
- `duration`: Suspension duration (if temporary)

#### `access.user_activated`
**Description:** User account activated
**Severity:** Info
**Fields:**
- `user_id`: Activated user identifier
- `activated_by`: User who activated the account

#### `access.api_token_created`
**Description:** API token created
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `token_id`: Token identifier
- `token_name`: Token name
- `scopes`: Token scopes
- `expires_at`: Token expiration

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.9.2 (User Access Management)

#### `access.api_token_deleted`
**Description:** API token deleted
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `token_id`: Token identifier
- `deleted_by`: User who deleted the token

#### `access.api_token_rotated`
**Description:** API token rotated
**Severity:** Medium
**Fields:**
- `user_id`: User identifier
- `token_id`: Token identifier
- `rotated_by`: User who rotated the token

---

### 4. Configuration Events

#### `config.changed`
**Description:** Configuration changed
**Severity:** Medium
**Fields:**
- `config_section`: Configuration section changed
- `config_key`: Configuration key changed
- `old_value`: Previous value (if sensitive, masked)
- `new_value`: New value (if sensitive, masked)
- `changed_by`: User who made the change
- `ip_address`: IP address of change

**Compliance:**
- SOC 2: CC7 (System Operations)
- ISO 27001: A.12.1 (Operational Procedures)

#### `config.security_policy_updated`
**Description:** Security policy updated
**Severity:** High
**Fields:**
- `policy_name`: Policy name
- `policy_version`: Policy version
- `updated_by`: User who updated the policy
- `changes`: Summary of changes

#### `config.encryption_key_rotated`
**Description:** Encryption key rotated
**Severity:** High
**Fields:**
- `key_id`: Key identifier
- `key_type`: Key type
- `rotated_by`: User who rotated the key
- `rotation_method`: Rotation method

**Compliance:**
- SOC 2: CC5 (Control Activities)
- ISO 27001: A.10.2 (Key Management)

#### `config.tls_certificate_updated`
**Description:** TLS certificate updated
**Severity:** High
**Fields:**
- `certificate_id`: Certificate identifier
- `updated_by`: User who updated the certificate
- `expires_at`: Certificate expiration

---

### 5. Data Events

#### `data.exported`
**Description:** Data export
**Severity:** Medium
**Fields:**
- `user_id`: User who exported data
- `data_type`: Type of data exported
- `record_count`: Number of records exported
- `export_format`: Export format
- `destination`: Export destination (if applicable)

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.8.2 (Information Classification)

#### `data.deleted`
**Description:** Data deletion
**Severity:** High
**Fields:**
- `user_id`: User who deleted data
- `data_type`: Type of data deleted
- `record_count`: Number of records deleted
- `deletion_method`: Deletion method (soft/hard)

**Compliance:**
- SOC 2: CC6 (Logical Access)
- ISO 27001: A.8.2 (Information Classification)

#### `data.encrypted`
**Description:** Data encryption
**Severity:** Info
**Fields:**
- `data_type`: Type of data encrypted
- `encryption_method`: Encryption method used
- `key_id`: Encryption key identifier

#### `data.decrypted`
**Description:** Data decryption
**Severity:** Medium
**Fields:**
- `user_id`: User who decrypted data
- `data_type`: Type of data decrypted
- `key_id`: Decryption key identifier
- `purpose`: Purpose of decryption

#### `data.classified`
**Description:** Data classification
**Severity:** Info
**Fields:**
- `data_type`: Type of data classified
- `classification`: Classification level
- `classified_by`: User who classified the data

---

### 6. Security Events

#### `security.vulnerability_detected`
**Description:** Vulnerability detected
**Severity:** High
**Fields:**
- `vulnerability_id`: Vulnerability identifier
- `vulnerability_type`: Type of vulnerability
- `severity`: Vulnerability severity
- `component`: Affected component
- `description`: Vulnerability description
- `remediation`: Remediation steps

**Compliance:**
- SOC 2: CC4 (Monitoring Activities)
- ISO 27001: A.12.6 (Technical Vulnerability Management)

#### `security.threat_detected`
**Description:** Threat detected
**Severity:** Critical
**Fields:**
- `threat_id`: Threat identifier
- `threat_type`: Type of threat
- `severity`: Threat severity
- `source`: Threat source
- `target`: Threat target
- `indicators`: Threat indicators

**Compliance:**
- SOC 2: CC4 (Monitoring Activities)
- ISO 27001: A.16.1 (Incident Management)

#### `security.anomaly_detected`
**Description:** Anomaly detected
**Severity:** Medium
**Fields:**
- `anomaly_type`: Type of anomaly
- `severity`: Anomaly severity
- `description`: Anomaly description
- `indicators`: Anomaly indicators

#### `security.rate_limit_exceeded`
**Description:** Rate limit exceeded
**Severity:** Medium
**Fields:**
- `user_id`: User identifier (if authenticated)
- `ip_address`: Client IP address
- `endpoint`: Endpoint accessed
- `limit`: Rate limit value
- `actual`: Actual request count

#### `security.suspicious_activity`
**Description:** Suspicious activity detected
**Severity:** High
**Fields:**
- `user_id`: User identifier (if applicable)
- `ip_address`: Client IP address
- `activity_type`: Type of suspicious activity
- `indicators`: Activity indicators
- `risk_score`: Risk score

**Compliance:**
- SOC 2: CC4 (Monitoring Activities)
- ISO 27001: A.16.1 (Incident Management)

---

### 7. Compliance Events

#### `compliance.audit_log_accessed`
**Description:** Audit log accessed
**Severity:** Medium
**Fields:**
- `user_id`: User who accessed audit log
- `access_type`: Type of access (view, export, search)
- `filters`: Filters applied
- `record_count`: Number of records accessed

**Compliance:**
- SOC 2: CC4 (Monitoring Activities)
- ISO 27001: A.12.7 (Information Systems Audit Considerations)

#### `compliance.compliance_check`
**Description:** Compliance check performed
**Severity:** Info
**Fields:**
- `check_type`: Type of compliance check
- `standard`: Compliance standard (SOC2, ISO27001)
- `result`: Check result (pass, fail, warning)
- `findings`: Compliance findings

#### `compliance.policy_violation`
**Description:** Policy violation detected
**Severity:** High
**Fields:**
- `policy_name`: Policy name
- `violation_type`: Type of violation
- `user_id`: User identifier (if applicable)
- `resource`: Resource involved
- `severity`: Violation severity

---

## Event Severity Levels

- **Critical**: Immediate action required (threats, data breaches)
- **High**: Urgent action required (privilege escalation, policy violations)
- **Medium**: Action required (access denials, configuration changes)
- **Low**: Informational (successful operations, routine events)

---

## Event Retention

- **Critical/High**: 7 years (compliance requirement)
- **Medium**: 2 years
- **Low**: 90 days

---

**Last Updated:** 2025-01-27
