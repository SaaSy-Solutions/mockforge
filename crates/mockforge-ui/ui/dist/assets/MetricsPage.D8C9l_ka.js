import{r as L,j as e}from"./react-vendor.CjFKJWOU.js";import{w as O,P as g,E as u,x as R,A as v,n as p,o as y,y as E,m as U,Z as $,M as h,e as q}from"./index.js";import{T as k}from"./trending-up.DgqH4lqx.js";import"./chart-vendor.Bws7AqQX.js";import"./query-vendor.CB8uHlA8.js";import"./ui-vendor.B5WCADYB.js";import"./state-vendor.RQj9JU5O.js";function N({data:t,title:d}){const c=Math.max(...t.map(s=>s.value));return t.length===0||c===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No data available"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d}),e.jsx("div",{className:"space-y-3",children:t.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 text-sm text-gray-600 dark:text-gray-400 truncate",children:s.label}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${s.color}`,style:{width:`${s.value/c*100}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 min-w-[3rem] text-right",children:s.value})]})})]},a))})]})}function D({data:t,title:d}){var m,l;if(t.length===0)return null;const c=t.map(o=>o.value),s=Math.min(...c),n=Math.max(...c)-s||1;return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d}),e.jsx("div",{className:"h-32 flex items-end gap-1",children:t.map((o,x)=>e.jsx("div",{className:"flex-1 bg-blue-500 rounded-t-sm transition-all duration-300",style:{height:`${(o.value-s)/n*100}%`,minHeight:"4px"},title:`${new Date(o.timestamp).toLocaleTimeString()}: ${o.value}`},x))}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:new Date((m=t[0])==null?void 0:m.timestamp).toLocaleTimeString()}),e.jsx("span",{children:new Date((l=t[t.length-1])==null?void 0:l.timestamp).toLocaleTimeString()})]})]})}function K(){const{data:t,isLoading:d,error:c}=O(),s=n=>typeof n=="number"?n:typeof n=="string"&&parseFloat(n)||0,a=L.useMemo(()=>{var _,w,M;if(!t)return null;const n=Object.entries(t.requests_by_endpoint||{}).map(([r,i])=>({label:r.split(" ")[1]||r,value:s(i),color:"bg-blue-500"})),m=[{label:"P50",value:s((_=t.response_time_percentiles)==null?void 0:_.p50),color:"bg-green-500"},{label:"P95",value:s((w=t.response_time_percentiles)==null?void 0:w.p95),color:"bg-yellow-500"},{label:"P99",value:s((M=t.response_time_percentiles)==null?void 0:M.p99),color:"bg-red-500"}],l=Object.entries(t.error_rate_by_endpoint||{}).map(([r,i])=>{const f=s(i);return{label:r.split(" ")[1]||r,value:Math.round(f*100),color:f>.1?"bg-red-500":f>.05?"bg-yellow-500":"bg-green-500"}}),x=Object.values(t.requests_by_endpoint||{}).map(s).reduce((r,i)=>r+i,0),j=Object.values(t.response_time_percentiles||{}).map(s),P=j.length>0?Math.round(j.reduce((r,i)=>r+i,0)/j.length):0,b=Object.values(t.error_rate_by_endpoint||{}).map(s),S=b.length>0?b.reduce((r,i)=>r+i,0)/b.length*100:0,T=Object.keys(t.requests_by_endpoint||{}).length,A=(t.memory_usage_over_time||[]).filter(r=>Array.isArray(r)&&r.length===2).map(([r,i])=>({timestamp:String(r),value:s(i)})),C=(t.cpu_usage_over_time||[]).filter(r=>Array.isArray(r)&&r.length===2).map(([r,i])=>({timestamp:String(r),value:s(i)}));return{endpointData:n,responseTimeData:m,errorRateData:l,totalRequests:x,avgResponseTime:P,avgErrorRate:S,activeEndpoints:T,memoryData:A,cpuData:C}},[t]);return d?e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{title:"Performance Metrics",subtitle:"Monitor system performance and request analytics"}),e.jsx(u,{icon:e.jsx(R,{className:"h-12 w-12"}),title:"Loading metrics...",description:"Fetching performance data and analytics."})]}):c?e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{title:"Performance Metrics",subtitle:"Monitor system performance and request analytics"}),e.jsx(v,{type:"error",title:"Failed to load metrics",message:c instanceof Error?c.message:"Unable to fetch performance metrics. Please try again."})]}):t?a?e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{title:"Performance Metrics",subtitle:"Real-time system performance and request analytics"}),e.jsx(p,{title:"Key Performance Indicators",subtitle:"Critical system metrics at a glance",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(y,{title:"Total Requests",value:a.totalRequests.toLocaleString(),subtitle:"all endpoints",icon:e.jsx(E,{className:"h-6 w-6"})}),e.jsx(y,{title:"Avg Response Time",value:`${a.avgResponseTime}ms`,subtitle:"median",icon:e.jsx(U,{className:"h-6 w-6"})}),e.jsx(y,{title:"Error Rate",value:`${a.avgErrorRate.toFixed(1)}%`,subtitle:"average",icon:e.jsx(k,{className:"h-6 w-6"})}),e.jsx(y,{title:"Active Endpoints",value:a.activeEndpoints.toString(),subtitle:"with traffic",icon:e.jsx($,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(p,{title:"Request Distribution",subtitle:"Traffic breakdown by endpoint",children:e.jsx(h,{children:a.endpointData.length>0?e.jsx(N,{data:a.endpointData,title:"Requests by Endpoint"}):e.jsx(u,{icon:e.jsx(R,{className:"h-8 w-8"}),title:"No request data",description:"Start making API calls to see request distribution."})})}),e.jsx(p,{title:"Response Time Analysis",subtitle:"Latency percentiles across all requests",children:e.jsx(h,{children:e.jsx(N,{data:a.responseTimeData,title:"Response Time Percentiles (ms)"})})}),e.jsx(p,{title:"Error Rate Analysis",subtitle:"Error rates by endpoint",children:e.jsx(h,{children:a.errorRateData.length>0?e.jsx(N,{data:a.errorRateData,title:"Error Rates by Endpoint (%)"}):e.jsx(u,{icon:e.jsx(k,{className:"h-8 w-8"}),title:"No error data",description:"Error rates will appear here when requests fail."})})}),e.jsx(p,{title:"System Resource Usage",subtitle:"Memory and CPU usage over time",children:e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[a.memoryData.length>0&&e.jsx(D,{data:a.memoryData,title:"Memory Usage (MB)"}),a.cpuData.length>0&&e.jsx(D,{data:a.cpuData,title:"CPU Usage (%)"}),!a.memoryData.length&&!a.cpuData.length&&e.jsx(u,{icon:e.jsx(E,{className:"h-8 w-8"}),title:"No time series data",description:"System metrics will appear here over time."})]})})})]}),e.jsx(p,{title:"Endpoint Performance",subtitle:"Detailed performance metrics for each endpoint",children:e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("caption",{className:"sr-only",children:"Endpoint performance metrics showing requests, error rates, and health status"}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{scope:"col",className:"text-left py-3 px-4 font-semibold text-gray-900 dark:text-gray-100",children:"Endpoint"}),e.jsx("th",{scope:"col",className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-gray-100",children:"Requests"}),e.jsx("th",{scope:"col",className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-gray-100",children:"Error Rate"}),e.jsx("th",{scope:"col",className:"text-right py-3 px-4 font-semibold text-gray-900 dark:text-gray-100",children:"Status"})]})}),e.jsx("tbody",{children:Object.entries(t.requests_by_endpoint||{}).map(([n,m])=>{var x;const l=s((x=t.error_rate_by_endpoint)==null?void 0:x[n]),o=s(m);return e.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-3 px-4 font-mono text-sm text-gray-900 dark:text-gray-100",children:n}),e.jsx("td",{className:"py-3 px-4 text-right text-gray-900 dark:text-gray-100",children:o.toLocaleString()}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsxs(q,{variant:l>.1?"error":l>.05?"warning":"success",size:"sm",children:[(l*100).toFixed(1),"%"]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:e.jsx(q,{variant:l===0?"success":"warning",size:"sm",children:l===0?"Healthy":"Issues"})})]},n)})})]})})})})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{title:"Performance Metrics",subtitle:"Monitor system performance and request analytics"}),e.jsx(v,{type:"warning",title:"Processing metrics...",message:"Processing metrics data."})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{title:"Performance Metrics",subtitle:"Monitor system performance and request analytics"}),e.jsx(v,{type:"warning",title:"No metrics available",message:"Metrics data is not available. Ensure the MockForge server is running and collecting metrics."})]})}export{K as MetricsPage};
