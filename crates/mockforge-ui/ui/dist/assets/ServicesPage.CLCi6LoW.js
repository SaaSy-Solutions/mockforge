import{r as u,j as e}from"./react-vendor.CjFKJWOU.js";import{l as w,q as k,f,a as Y,r as M,s as T}from"./index.js";import{C as F}from"./ContextMenu.BAP_RUR8.js";import{B as S}from"./Badge.HqBhlCiq.js";import{C as R}from"./Card.DLDyS9TF.js";import"./chart-vendor.Bws7AqQX.js";import"./query-vendor.CB8uHlA8.js";import"./ui-vendor.B5WCADYB.js";import"./state-vendor.RQj9JU5O.js";function H(a,l={}){const{baseUrl:x="http://localhost:3000",headers:c={},body:h,followRedirects:d=!0,timeout:b=30}=l,n=["curl"];a.method&&a.method!=="GET"&&n.push(`-X ${a.method}`),d&&n.push("-L"),n.push(`--max-time ${b}`),Object.entries(c).forEach(([i,y])=>{n.push(`-H "${i}: ${y}"`)}),h&&(a.method==="POST"||a.method==="PUT"||a.method==="PATCH")&&n.push(`-d '${h}'`);const p=a.path.startsWith("http")?a.path:`${x}${a.path}`;return n.push(`"${p}"`),n.join(` \\
  `)}async function O(a){try{return await navigator.clipboard.writeText(a),!0}catch{try{const l=document.createElement("textarea");l.value=a,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();const x=document.execCommand("copy");return document.body.removeChild(l),x}catch(l){return w.error("Failed to copy to clipboard",l),!1}}}function G({service:a,onToggleService:l,onToggleRoute:x,expanded:c=!1,onToggleExpanded:h}){var v;const d=a.routes.filter(t=>t.enabled!==!1).length,b=a.routes.length,[n,p]=u.useState({visible:!1,position:{x:0,y:0},route:null}),i=(t,o)=>{t.preventDefault(),p({visible:!0,position:{x:t.clientX,y:t.clientY},route:o})},y=()=>{p(t=>({...t,visible:!1}))},j=async t=>{const o=H(t);await O(o)?w.info("cURL command copied to clipboard:",o):w.error("Failed to copy cURL command to clipboard")},m=t=>[{label:"Copy as cURL",onClick:()=>j(t),icon:"ðŸ“‹"}];return e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{checked:a.enabled,onCheckedChange:t=>l(a.id,t)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:a.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d,"/",b," routes enabled"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(v=a.tags)==null?void 0:v.map(t=>e.jsx("span",{className:"inline-flex items-center rounded-full bg-secondary px-2 py-1 text-xs font-medium",children:t},t)),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>h(a.id),children:c?"â†‘":"â†“"})]})]}),a.description&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:a.description})]}),c&&e.jsxs("div",{className:"border-t p-4 space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:"Routes"}),a.routes.map(t=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded border bg-background cursor-context-menu",onContextMenu:o=>i(o,t),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{checked:t.enabled!==!1,onCheckedChange:o=>x(a.id,`${t.method}-${t.path}`,o),disabled:!a.enabled}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:Y("text-xs font-mono px-2 py-1 rounded",{"bg-green-100 text-green-800":t.method==="GET","bg-blue-100 text-blue-800":t.method==="POST","bg-yellow-100 text-yellow-800":t.method==="PUT","bg-red-100 text-red-800":t.method==="DELETE","bg-purple-100 text-purple-800":t.method==="PATCH","bg-gray-100 text-gray-800":!t.method}),children:t.method||"gRPC"}),e.jsx("span",{className:"font-mono text-sm",children:t.path})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.request_count," requests"]}),t.latency_ms&&e.jsxs("span",{children:[t.latency_ms,"ms avg"]}),(t.error_count||0)>0&&e.jsxs("span",{className:"text-destructive",children:[t.error_count||0," errors"]})]})]},`${t.method}-${t.path}`))]}),n.visible&&n.route&&e.jsx(F,{items:m(n.route),position:n.position,onClose:y})]})}function W({services:a,onUpdateService:l,onToggleRoute:x}){const[c,h]=u.useState(new Set),[d,b]=u.useState(""),[n,p]=u.useState(new Set),{filteredRoutes:i}=M(),[y,j]=u.useState(!1),[m,v]=u.useState(1),t=20,o=Array.from(new Set(a.flatMap(s=>s.tags||[]))),g=a.filter(s=>{const r=d===""||s.name.toLowerCase().includes(d.toLowerCase())||s.routes.some(C=>C.path.toLowerCase().includes(d.toLowerCase())),D=n.size===0||s.tags&&s.tags.some(C=>n.has(C));return r&&D}),$=(s,r)=>{l(s,{enabled:r})},E=s=>{const r=new Set(c);r.has(s)?r.delete(s):r.add(s),h(r)},A=()=>{g.forEach(s=>{l(s.id,{enabled:!0})})},P=()=>{g.forEach(s=>{l(s.id,{enabled:!1})})},z=s=>{const r=new Set(n);r.has(s)?r.delete(s):r.add(s),p(r)},L=g.filter(s=>s.enabled).length,U=u.useMemo(()=>a.reduce((s,r)=>s+r.routes.length,0),[a]),q=i.length!==U,B=i.slice(0,3),N=Math.max(1,Math.ceil(i.length/t)),_=i.slice((m-1)*t,m*t);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Services"}),e.jsxs("p",{className:"text-muted-foreground",children:[L,"/",g.length," services enabled"]})]}),q&&e.jsx("div",{className:"flex-1 md:flex-none",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Matching Routes: ",i.length]}),e.jsx("div",{className:"hidden lg:flex items-center gap-2",children:B.map((s,r)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-md border border-border bg-bg-primary",children:[s.method&&e.jsx(S,{variant:"brand",className:"uppercase",children:s.method}),e.jsx("span",{className:"font-mono text-xs text-gray-600 dark:text-gray-400 max-w-[240px] truncate",title:s.path,children:s.path})]},`${s.method??"ANY"}-${s.path}-${r}`))}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>j(!0),children:"View all"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:A,children:"Enable All"}),e.jsx(f,{variant:"outline",size:"sm",onClick:P,children:"Disable All"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Search services and routes...",value:d,onChange:s=>b(s.target.value),className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"}),o.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Filter by tags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(s=>e.jsx("button",{onClick:()=>z(s),className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium transition-colors ${n.has(s)?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:s},s))})]})]}),e.jsx("div",{className:"space-y-4",children:g.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No services found matching your criteria."}):g.map(s=>e.jsx(G,{service:s,onToggleService:$,onToggleRoute:x,expanded:c.has(s.id),onToggleExpanded:E},s.id))}),y&&e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-bg-overlay",onClick:()=>j(!1)}),e.jsxs("div",{className:"fixed inset-x-0 top-16 mx-auto w-full max-w-3xl bg-bg-primary border border-border rounded-xl shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["Matching Routes (",i.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Page ",m," / ",N]}),e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>j(!1),children:"Close"})]})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-border",children:_.map((s,r)=>e.jsxs("li",{className:"px-6 py-3 flex items-center gap-3",children:[s.method&&e.jsx(S,{variant:"brand",className:"uppercase",children:s.method}),e.jsx("span",{className:"font-mono text-sm text-gray-900 dark:text-gray-100 truncate",title:s.path,children:s.path}),s.tags&&s.tags.length>0&&e.jsx("span",{className:"ml-auto text-xs text-gray-600 dark:text-gray-400",children:s.tags.join(", ")})]},`${s.method??"ANY"}-${s.path}-${r}`))})}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-t border-border bg-bg-secondary/30",children:[e.jsx(f,{size:"sm",variant:"outline",onClick:()=>v(s=>Math.max(1,s-1)),disabled:m===1,children:"Previous"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Showing ",(m-1)*t+1," - ",Math.min(m*t,i.length)," of ",i.length]}),e.jsx(f,{size:"sm",variant:"outline",onClick:()=>v(s=>Math.min(N,s+1)),disabled:m===N,children:"Next"})]})]})]})]})}function te(){const{services:a,updateService:l,toggleRoute:x,filteredRoutes:c}=M(),h=a.reduce((n,p)=>n+p.routes.length,0),d=c.length!==h;return a.length>0?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900 dark:text-gray-100",children:"Services"}),e.jsx("p",{className:"text-base text-gray-600 dark:text-gray-400 mt-1",children:"Manage services and routes. Use global search to quickly filter routes."})]}),e.jsx(R,{title:"Matching Routes",icon:e.jsx(T,{className:"h-4 w-4"}),className:d?"":"opacity-70",children:d?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[c.length," routes match your search."]}),e.jsx("ul",{className:"divide-y divide-border rounded-md border border-border bg-bg-primary",children:c.slice(0,10).map(n=>e.jsxs("li",{className:"px-4 py-3 flex items-center gap-3",children:[e.jsx(S,{variant:"brand",className:"uppercase",children:n.method||"ANY"}),e.jsx("span",{className:"font-mono text-sm text-gray-900 dark:text-gray-100 truncate",title:n.path,children:n.path})]},n.id))}),c.length>10&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Showing first 10 resultsâ€¦ refine your query to narrow further."})]}):e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No search active. Type in the header's global search to filter routes."})}),e.jsx(W,{services:a,onUpdateService:l,onToggleRoute:x})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900 dark:text-gray-100",children:"Services"}),e.jsx("p",{className:"text-base text-gray-600 dark:text-gray-400 mt-1",children:"Manage services and routes. Use global search to quickly filter routes."})]}),e.jsx(R,{title:"No Services",icon:e.jsx(T,{className:"h-4 w-4"}),children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No services configured. Add a service to get started."})})]})}export{te as ServicesPage};
