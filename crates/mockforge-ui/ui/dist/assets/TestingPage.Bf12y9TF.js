import{r as j,j as e}from"./react-vendor.CjFKJWOU.js";import{P as A,f as m,R as B,n as g,M as i,ah as v,ai as T,aj as w,m as u,e as M,T as S,j as $,ak as z,al as C}from"./index.js";import{P as R}from"./play.DFhY6Mwp.js";import"./chart-vendor.Bws7AqQX.js";import"./query-vendor.CB8uHlA8.js";import"./ui-vendor.B5WCADYB.js";import"./state-vendor.RQj9JU5O.js";function K(){var b,N;const[h]=j.useState(null),[p,n]=j.useState(!1),[d,l]=j.useState([{id:"smoke-tests",name:"Smoke Tests",description:"Basic functionality and endpoint availability tests",status:"idle",totalTests:0,passedTests:0,failedTests:0,duration:0,tests:[]},{id:"health-check",name:"Health Check",description:"System health and service availability check",status:"idle",totalTests:1,passedTests:0,failedTests:0,duration:0,tests:[{id:"health",name:"Health Endpoint",status:"pending",duration:0,timestamp:new Date().toISOString()}]},{id:"integration-tests",name:"Integration Tests",description:"Custom integration tests for API endpoints",status:"idle",totalTests:0,passedTests:0,failedTests:0,duration:0,tests:[]}]),D=(t,s)=>({id:`smoke-${s}`,name:t.test_name,status:t.passed?"passed":"failed",duration:t.response_time_ms||0,error:t.error_message,timestamp:new Date().toISOString()}),f=async()=>{n(!0),l(t=>t.map(s=>s.id==="smoke-tests"?{...s,status:"running"}:s));try{const t=Date.now(),s=await C.runSmokeTests(),a=Date.now(),x=(await C.getSmokeTests()).map((o,r)=>D(o,r));l(o=>o.map(r=>r.id==="smoke-tests"?{...r,status:s.failed_tests>0?"failed":"completed",totalTests:s.total_tests,passedTests:s.passed_tests,failedTests:s.failed_tests,duration:a-t,tests:x}:r))}catch(t){l(s=>s.map(a=>a.id==="smoke-tests"?{...a,status:"failed",failedTests:1,tests:[{id:"smoke-error",name:"Smoke Tests Execution",status:"failed",duration:0,error:t instanceof Error?t.message:"Unknown error",timestamp:new Date().toISOString()}]}:a))}finally{n(!1)}},y=async()=>{n(!0),l(t=>t.map(s=>s.id==="health-check"?{...s,status:"running",tests:s.tests.map(a=>({...a,status:"running"}))}:s));try{const t=Date.now(),s=await z.getHealth(),a=Date.now(),c=s.status==="healthy"||s.status==="ok",x=s.issues||[];l(o=>o.map(r=>r.id==="health-check"?{...r,status:c?"completed":"failed",passedTests:c?1:0,failedTests:c?0:1,duration:a-t,tests:[{id:"health",name:"Health Endpoint",status:c?"passed":"failed",duration:a-t,error:x.length>0?x.join(", "):void 0,timestamp:new Date().toISOString()}]}:r))}catch(t){l(s=>s.map(a=>a.id==="health-check"?{...a,status:"failed",failedTests:1,passedTests:0,tests:[{id:"health",name:"Health Endpoint",status:"failed",duration:0,error:t instanceof Error?t.message:"Failed to fetch health status",timestamp:new Date().toISOString()}]}:a))}finally{n(!1)}},P=async t=>{switch(t){case"smoke-tests":await f();break;case"health-check":await y();break;case"integration-tests":n(!0),l(s=>s.map(a=>a.id===t?{...a,status:"completed",tests:[{id:"integration-placeholder",name:"Custom integration tests not configured",status:"pending",duration:0,timestamp:new Date().toISOString()}]}:a)),n(!1);break}},E=async()=>{await y(),await f()},k=t=>{switch(t){case"passed":return e.jsx(T,{className:"h-4 w-4 text-green-600"});case"failed":return e.jsx(w,{className:"h-4 w-4 text-red-600"});case"running":return e.jsx(u,{className:"h-4 w-4 text-blue-600 animate-spin"});case"pending":return e.jsx(u,{className:"h-4 w-4 text-gray-400"});default:return e.jsx(S,{className:"h-4 w-4 text-yellow-600"})}},F=t=>{switch(t){case"passed":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";case"running":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"pending":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}},I=d.reduce((t,s)=>t+s.totalTests,0),O=d.reduce((t,s)=>t+s.passedTests,0),_=d.reduce((t,s)=>t+s.failedTests,0),H=d.reduce((t,s)=>t+s.duration,0);return e.jsxs("div",{className:"space-y-8",children:[e.jsx(A,{title:"Testing Suite",subtitle:"Run automated tests and validate MockForge functionality",action:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>l(t=>t.map(s=>({...s,status:"idle",passedTests:0,failedTests:0,duration:0,tests:s.tests.map(a=>({...a,status:"pending",duration:0,error:void 0}))}))),disabled:p,className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Reset"]}),e.jsxs(m,{variant:"default",size:"sm",onClick:E,disabled:p,className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Run All Tests"]})]})}),e.jsx(g,{title:"Test Overview",subtitle:"Summary of test execution results",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400",children:e.jsx(v,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:I}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Tests"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400",children:e.jsx(T,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:O}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Passed"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400",children:e.jsx(w,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:_}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Failed"})]})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-lg bg-yellow-50 dark:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400",children:e.jsx(u,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[(H/1e3).toFixed(1),"s"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Time"})]})]})})]})}),e.jsx(g,{title:"Test Suites",subtitle:"Organized collections of automated tests",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:d.map(t=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),t.name]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.description})]}),e.jsx(M,{variant:t.status==="completed"?"success":t.status==="failed"?"error":t.status==="running"?"info":"outline",children:t.status})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.totalTests}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-green-600 dark:text-green-400",children:t.passedTests}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Passed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-red-600 dark:text-red-400",children:t.failedTests}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Failed"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[t.tests.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[k(s.status),e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-100",children:s.name})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:s.duration>0?`${s.duration.toFixed(0)}ms`:""})]},s.id)),t.tests.length>5&&e.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400",children:["+",t.tests.length-5," more tests"]})]}),e.jsx(m,{onClick:()=>P(t.id),disabled:p||t.status==="running",className:"w-full flex items-center gap-2",variant:t.status==="running"?"outline":"default",children:t.status==="running"?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-4 w-4 animate-spin"}),"Running Tests..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4"}),"Run ",t.name]})})]},t.id))})}),h&&e.jsx(g,{title:`Test Results: ${(b=d.find(t=>t.id===h))==null?void 0:b.name}`,subtitle:"Detailed test execution results",children:e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:(N=d.find(t=>t.id===h))==null?void 0:N.tests.map(t=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[k(t.status),e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F(t.status)}`,children:t.status}),t.duration>0&&e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.duration.toFixed(0),"ms"]})]})]}),t.error&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-red-800 dark:text-red-200",children:t.error})]})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["Executed at ",new Date(t.timestamp).toLocaleString()]})]},t.id))})})}),e.jsx(g,{title:"Test Configuration",subtitle:"Configure test execution settings",children:e.jsxs(i,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Test Timeout (seconds)"}),e.jsx($,{type:"number",defaultValue:"30",min:"1",max:"300"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Parallel Execution"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"sequential",children:"Sequential"}),e.jsx("option",{value:"parallel",children:"Parallel"}),e.jsx("option",{value:"limited",children:"Limited Parallel (4)"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Test Environment"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"environment",value:"development",defaultChecked:!0,className:"mr-2"}),"Development"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"environment",value:"staging",className:"mr-2"}),"Staging"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"environment",value:"production",className:"mr-2"}),"Production"]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200 dark:border-gray-700",children:e.jsx(m,{children:"Save Configuration"})})]})})]})}export{K as TestingPage};
