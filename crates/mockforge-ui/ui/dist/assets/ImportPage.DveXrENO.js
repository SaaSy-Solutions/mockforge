import{r as d,j as e}from"./react-vendor.CjFKJWOU.js";import{c as $,am as Y,an as Z,ao as K,ap as Q,P as ee,aq as se,ar as ae,as as I,F as _,at as z,n as w,B as j,H as te,A as P,ai as B,aj as T,T as re,t as ne,l as R,au as O,k as q,av as le,aw as ie,E as ce,J as oe,m as de,ax as me}from"./index.js";import{u as D}from"./index.BfCLqjMY.js";import{G as E}from"./globe.DUkIu56i.js";import{H as V}from"./history.CF46tFWb.js";import"./chart-vendor.Bws7AqQX.js";import"./query-vendor.CB8uHlA8.js";import"./ui-vendor.B5WCADYB.js";import"./state-vendor.RQj9JU5O.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],A=$("code",xe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],U=$("file",he);function ue({onFileSelect:t,format:i}){const[m,a]=d.useState(!1),[o,f]=d.useState(null),p=d.useCallback(c=>{c.preventDefault(),a(!0)},[]),s=d.useCallback(c=>{c.preventDefault(),a(!1)},[]),u=d.useCallback(c=>{const x=new FileReader;x.onload=y=>{var k;const b=(k=y.target)==null?void 0:k.result;t(b,c.name),f(c.name)},x.readAsText(c)},[t]),S=d.useCallback(c=>{c.preventDefault(),a(!1);const x=Array.from(c.dataTransfer.files);x.length>0&&u(x[0])},[u]),r=d.useCallback(c=>{const x=c.target.files;x&&x.length>0&&u(x[0])},[u]),N=()=>{switch(i){case"postman":return e.jsx(_,{className:"h-8 w-8 text-orange-500"});case"insomnia":return e.jsx(E,{className:"h-8 w-8 text-purple-500"});case"curl":return e.jsx(A,{className:"h-8 w-8 text-green-500"});default:return e.jsx(me,{className:"h-8 w-8 text-gray-500"})}},h=()=>{switch(i){case"postman":return"Postman Collection";case"insomnia":return"Insomnia Export";case"curl":return"cURL Commands";default:return"File"}},v=()=>{switch(i){case"postman":return".json,.postman_collection";case"insomnia":return".json,.insomnia";case"curl":return".txt,.sh,.curl";default:return"*"}};return e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${m?"border-primary bg-primary/5":"border-gray-300 dark:border-gray-600 hover:border-primary/50"}`,onDragOver:p,onDragLeave:s,onDrop:S,children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[N(),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:o?`Selected: ${o}`:`Drop ${h()} here`}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"or click to browse files"})]}),e.jsx("input",{type:"file",accept:v(),onChange:r,className:"hidden",id:`file-upload-${i}`}),e.jsx("label",{htmlFor:`file-upload-${i}`,style:{cursor:"pointer"},children:e.jsx(j,{variant:"outline",type:"button",children:"Choose File"})})]})})}function pe({routes:t,onToggleRoute:i,selectedRoutes:m}){return t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No routes found to preview"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Generated Routes (",t.length,")"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{t.forEach((a,o)=>{m.has(o)||i(o)})},children:"Select All"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{m.forEach(a=>i(a))},children:"Deselect All"})]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.map((a,o)=>e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("input",{type:"checkbox",checked:m.has(o),onChange:()=>i(o),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(q,{variant:a.method==="GET"?"success":a.method==="POST"?"info":a.method==="PUT"?"warning":a.method==="DELETE"?"error":"default",children:a.method}),e.jsx("code",{className:"text-sm bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:a.path})]}),a.response&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Response: ",a.response.status," ",a.response.status>=200&&a.response.status<300?"✅":a.response.status>=400?"❌":"⚠️"]}),a.body&&e.jsx("div",{className:"mt-2",children:e.jsxs("details",{className:"text-sm",children:[e.jsxs("summary",{className:"cursor-pointer text-gray-600 dark:text-gray-400",children:["Request Body (",a.body.length," chars)"]}),e.jsx("pre",{className:"mt-2 bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs overflow-x-auto",children:a.body})]})})]})]})},o))})]})}function ge({onHistoryEntryClick:t}){const{data:i,isLoading:m,error:a}=le(),o=ie(),f=s=>new Date(s).toLocaleString(),p=s=>{switch(s.toLowerCase()){case"postman":return e.jsx(_,{className:"h-4 w-4 text-orange-500"});case"insomnia":return e.jsx(E,{className:"h-4 w-4 text-purple-500"});case"curl":return e.jsx(A,{className:"h-4 w-4 text-green-500"});default:return e.jsx(U,{className:"h-4 w-4 text-gray-500"})}};return m?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Loading import history..."})]}):a?e.jsxs(P,{type:"error",children:[e.jsx(T,{className:"h-4 w-4"}),"Failed to load import history: ",a.message]}):!i||i.imports.length===0?e.jsx(ce,{icon:e.jsx(V,{className:"h-8 w-8"}),title:"No Import History",description:"Your import history will appear here after you import collections."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Import History (",i.total,")"]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>o.mutate(),loading:o.isPending,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Clear History"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:i.imports.map(s=>e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:s.success?e.jsx(B,{className:"h-5 w-5 text-green-500"}):e.jsx(T,{className:"h-5 w-5 text-red-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p(s.format),e.jsx("span",{className:"font-medium capitalize",children:s.format}),e.jsx(q,{variant:s.success?"success":"error",children:s.success?"Success":"Failed"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx(U,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s.filename}),e.jsx(de,{className:"h-3 w-3 ml-2"}),e.jsx("span",{children:f(s.timestamp)})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{children:["Routes: ",s.routes_count]}),(s.variables_count??0)>0&&e.jsxs("span",{children:["Variables: ",s.variables_count]}),(s.warnings_count??0)>0&&e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:["Warnings: ",s.warnings_count]})]}),s.environment&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Environment: ",s.environment]}),s.base_url&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Base URL: ",s.base_url]}),s.error_message&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 mt-2 bg-red-50 dark:bg-red-900/20 p-2 rounded",children:["Error: ",s.error_message]})]})]}),t&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>t(s),children:"View Details"})]})},s.id))})]})}function Ie(){var L,H;const[t,i]=d.useState("postman"),[m,a]=d.useState(""),[o,f]=d.useState(""),[p,s]=d.useState(""),[u,S]=d.useState(""),[r,N]=d.useState(null),[h,v]=d.useState(new Set),c=Y(),x=Z(),y=K(),b=Q(),k=d.useCallback((n,l)=>{a(n),f(l),N(null),v(new Set)},[]),G=async()=>{if(!m)return;const n={content:m,filename:o,environment:p||void 0,base_url:u||void 0};try{const l=await c.mutateAsync(n);N(l),l.routes&&v(new Set(l.routes.map((F,C)=>C)))}catch(l){R.error("Preview failed",l)}},M=async()=>{var l,F,C;if(!m||!(r!=null&&r.routes))return;const n={content:m,filename:o,environment:p||void 0,base_url:u||void 0};try{let g;switch(t){case"postman":g=await x.mutateAsync(n);break;case"insomnia":g=await y.mutateAsync(n);break;case"curl":g=await b.mutateAsync(n);break;default:return}g.success?((l=D)==null||l.success(`Successfully imported ${h.size} routes!`),a(""),f(""),N(null),v(new Set)):(F=D)==null||F.error(`Import failed: ${g.error}`)}catch(g){R.error("Import failed",g),(C=D)==null||C.error("Import failed. Please check the console for details.")}},W=n=>{const l=new Set(h);l.has(n)?l.delete(n):l.add(n),v(l)},J=!m||c.isPending,X=!(r!=null&&r.success)||h.size===0||x.isPending||y.isPending||b.isPending;return e.jsxs("div",{className:"space-y-8",children:[e.jsx(ee,{title:"Import API Collections",subtitle:"Import routes from Postman, Insomnia, or cURL commands"}),e.jsxs(se,{value:t,onValueChange:n=>i(n),children:[e.jsxs(ae,{className:"grid w-full grid-cols-4",children:[e.jsxs(I,{value:"postman",className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:"Postman"})]}),e.jsxs(I,{value:"insomnia",className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:"Insomnia"})]}),e.jsxs(I,{value:"curl",className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"cURL"})]}),e.jsxs(I,{value:"history",className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"History"})]})]}),(t==="postman"||t==="insomnia"||t==="curl")&&e.jsxs(z,{value:t,className:"space-y-6",children:[e.jsx(w,{title:"Upload File",subtitle:`Upload your ${t} collection or export file`,children:e.jsx(ue,{onFileSelect:k,format:t})}),(t==="insomnia"||t==="postman")&&e.jsx(w,{title:"Configuration",subtitle:"Optional settings for import processing",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t==="insomnia"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Environment (optional)"}),e.jsx("input",{type:"text",value:p,onChange:n=>s(n.target.value),placeholder:"e.g., dev, staging, prod",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Base URL Override (optional)"}),e.jsx("input",{type:"text",value:u,onChange:n=>S(n.target.value),placeholder:"e.g., https://api.example.com",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800"})]})]})}),e.jsx(w,{title:"Preview Import",subtitle:"Review the routes that will be generated before importing",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(j,{onClick:G,disabled:J,loading:c.isPending,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Preview Routes"]}),r&&e.jsxs("div",{className:"space-y-4",children:[r.success?e.jsxs(P,{type:"success",children:[e.jsx(B,{className:"h-4 w-4"}),"Successfully parsed ",((L=r.routes)==null?void 0:L.length)||0," routes"]}):e.jsxs(P,{type:"error",children:[e.jsx(T,{className:"h-4 w-4"}),"Preview failed: ",r.error]}),r.warnings&&r.warnings.length>0&&e.jsxs(P,{type:"warning",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Warnings:"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:r.warnings.map((n,l)=>e.jsx("li",{className:"text-sm",children:n},l))})]})]}),r.routes&&e.jsx(pe,{routes:r.routes,onToggleRoute:W,selectedRoutes:h})]})]})}),e.jsx(w,{title:"Import Routes",subtitle:"Import the selected routes into MockForge",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(j,{onClick:M,disabled:X,loading:x.isPending||y.isPending||b.isPending,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Import ",h.size," Route",h.size!==1?"s":""]}),h.size>0&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.size," of ",((H=r==null?void 0:r.routes)==null?void 0:H.length)||0," routes selected"]})]})})]}),e.jsx(z,{value:"history",className:"space-y-6",children:e.jsx(w,{title:"Import History",subtitle:"View and manage your previous import activities",children:e.jsx(ge,{})})})]})]})}export{Ie as ImportPage};
