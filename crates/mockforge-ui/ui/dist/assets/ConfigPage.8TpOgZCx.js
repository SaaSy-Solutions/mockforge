import{r as u,j as e}from"./react-vendor.CjFKJWOU.js";import{c as re,W as ce,X as de,Y as ue,_ as ge,$ as xe,a0 as me,K as Y,a1 as pe,f as x,G as fe,L as Z,N as X,O as ee,j as f,V as ae,a2 as _,a3 as he,M as I,a4 as J,a5 as te,J as be,a6 as ye,a7 as je,a8 as ve,a9 as ke,aa as _e,ab as Ne,ac as we,ad as Ce,ae as Se,af as Pe,ag as Ee,l as G,P as se,R as Q,S as ne,Z as Ie,D as Te,n as A,e as Re,Q as Le,U as De}from"./index.js";import{u as c}from"./index.BfCLqjMY.js";import{a as Me,b as Fe,c as Ae}from"./ContextMenu.BAP_RUR8.js";import{G as Oe}from"./grip-vertical.Dc5g53Kr.js";import{P as Be}from"./play.DFhY6Mwp.js";import{S as Ue}from"./shield.D3o1gwXi.js";import"./chart-vendor.Bws7AqQX.js";import"./query-vendor.CB8uHlA8.js";import"./ui-vendor.B5WCADYB.js";import"./state-vendor.RQj9JU5O.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ve=re("save",$e);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],He=re("wifi-off",qe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],le=re("wifi",Ge),We=[{hex:"#3B82F6",name:"Blue"},{hex:"#EF4444",name:"Red"},{hex:"#10B981",name:"Green"},{hex:"#F59E0B",name:"Yellow"},{hex:"#8B5CF6",name:"Purple"},{hex:"#F97316",name:"Orange"},{hex:"#06B6D4",name:"Cyan"},{hex:"#84CC16",name:"Lime"}];function ze({workspaceId:i,onEnvironmentSelect:h}){const[P,L]=u.useState(!1),[j,D]=u.useState(null),[v,E]=u.useState({name:"",description:""}),[s,y]=u.useState({}),[d,k]=u.useState(null),[o,w]=u.useState(null),{data:g,isLoading:O,error:U}=ce(i),B=de(i),M=ue(i,(j==null?void 0:j.id)||""),F=ge(i),t=xe(i),n=me(i),C=async()=>{if(!v.name.trim()){_.error("Environment name is required");return}try{await B.mutateAsync({...v,name:v.name.trim()}),_.success(`Environment "${v.name}" created successfully`),E({name:"",description:""}),L(!1)}catch{_.error("Failed to create environment")}},m=async()=>{if(j)try{await M.mutateAsync(s),_.success(`Environment "${j.name}" updated successfully`),D(null),y({}),k(null)}catch{_.error("Failed to update environment")}},T=async a=>{if(a.is_global){_.error("Cannot delete global environment");return}if(confirm(`Are you sure you want to delete "${a.name}"? This action cannot be undone.`))try{await F.mutateAsync(a.id),_.success(`Environment "${a.name}" deleted successfully`)}catch{_.error("Failed to delete environment")}},b=async a=>{try{const l=a.is_global?"global":a.id;await t.mutateAsync(l),_.success(`Switched to "${a.name}" environment`),h==null||h(a.id)}catch{_.error("Failed to switch environment")}},p=a=>{D(a),y({name:a.name,description:a.description}),k(a.color||null)},$=(a,l)=>{w(l),a.dataTransfer.effectAllowed="move"},V=a=>{a.preventDefault(),a.dataTransfer.dropEffect="move"},W=async(a,l)=>{if(a.preventDefault(),!o||o===l){w(null);return}if(!(g!=null&&g.environments)){w(null);return}try{const S=g.environments.findIndex(q=>q.id===o),N=g.environments.findIndex(q=>q.id===l);if(S===-1||N===-1){w(null);return}const z=[...g.environments],[ie]=z.splice(S,1);z.splice(N,0,ie);const oe=z.map(q=>q.id);try{await n.mutateAsync(oe),_.success("Environment order updated")}catch{throw _.error("Failed to update environment order"),U}}catch{_.error("Failed to update environment order")}finally{w(null)}},r=({environment:a})=>{const{data:l}=he(i,a.id),S=o===a.id;return e.jsxs(Me,{children:[e.jsx(Fe,{children:e.jsxs(I,{draggable:!a.is_global,onDragStart:N=>$(N,a.id),onDragOver:V,onDrop:N=>W(N,a.id),className:`cursor-pointer transition-all duration-200 hover:shadow-lg ${a.active?"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-800/50"} ${S?"opacity-50":""} ${a.is_global?"":"cursor-move"}`,onClick:()=>b(a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[!a.is_global&&e.jsx("div",{className:"cursor-move p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(Oe,{className:"w-4 h-4 text-gray-400"})}),a.color&&e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:a.color.hex}}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.name,a.is_global&&e.jsx("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:"(Global)"})]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.variable_count," vars"]}),a.active&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]}),l&&l.variables.length>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.variables.slice(0,3).map(N=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200",children:N.name},N.name)),l.variables.length>3&&e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",l.variables.length-3," more"]})]})})]})}),e.jsxs(Ae,{children:[e.jsxs(J,{onClick:()=>b(a),children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Set as Active"]}),e.jsxs(J,{onClick:()=>p(a),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Edit Environment"]}),!a.is_global&&e.jsxs(J,{onClick:()=>T(a),className:"text-red-600 dark:text-red-400",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Delete Environment"]})]})]})};return O?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Environments"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(3)].map((a,l)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg"})},l))})]}):U?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Environments"})}),e.jsx("div",{className:"text-center py-8 text-red-600 dark:text-red-400",children:"Failed to load environments"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Environments"}),e.jsxs(Y,{open:P,onOpenChange:L,children:[e.jsx(pe,{asChild:!0,children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"New Environment"]})}),e.jsxs(Z,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Create New Environment"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(f,{value:v.name,onChange:a=>E(l=>({...l,name:a.target.value})),placeholder:"e.g., Development, Staging, Production"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description (Optional)"}),e.jsx(f,{value:v.description||"",onChange:a=>E(l=>({...l,description:a.target.value})),placeholder:"Brief description of this environment"})]})]}),e.jsxs(ae,{children:[e.jsx(x,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(x,{onClick:C,disabled:B.isPending,children:B.isPending?"Creating...":"Create Environment"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g==null?void 0:g.environments.sort((a,l)=>a.is_global&&!l.is_global?-1:!a.is_global&&l.is_global?1:(a.order||0)-(l.order||0)).map(a=>e.jsx(r,{environment:a},a.id))}),e.jsx(Y,{open:!!j,onOpenChange:a=>!a&&D(null),children:e.jsxs(Z,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Edit Environment"})}),j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name"}),e.jsx(f,{value:s.name||"",onChange:a=>y(l=>({...l,name:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description (Optional)"}),e.jsx(f,{value:s.description||"",onChange:a=>y(l=>({...l,description:a.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Color (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:We.map(a=>e.jsx("button",{onClick:()=>k(a),className:`w-8 h-8 rounded-full border-2 ${(d==null?void 0:d.hex)===a.hex?"border-gray-900 dark:border-gray-100":"border-gray-300 dark:border-gray-600"}`,style:{backgroundColor:a.hex},title:a.name},a.hex))}),d&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:d.hex}}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.name})]})]})]}),e.jsxs(ae,{children:[e.jsx(x,{variant:"outline",onClick:()=>D(null),children:"Cancel"}),e.jsx(x,{onClick:m,disabled:M.isPending,children:M.isPending?"Updating...":"Update Environment"})]})]})})]})}function Je({value:i,onChange:h,onSelect:P,placeholder:L,className:j,workspaceId:D,context:v,disabled:E=!1}){var F;const[s,y]=u.useState(!1),[d,k]=u.useState(-1),o=u.useRef(null),w=u.useRef(null),g=ye(D),O=u.useCallback(t=>{if(!g.data)return;const{start_position:n,end_position:C}=g.data,m=i.slice(0,n),T=i.slice(C),b=`${m}{{${t.text}}}}${T}`,p=m.length+t.text.length+4;h(b),P==null||P(t),setTimeout(()=>{var $,V;($=o.current)==null||$.setSelectionRange(p,p),(V=o.current)==null||V.focus()},0),y(!1),k(-1)},[i,h,P,g.data]),U=u.useCallback(t=>{const n=t.target.value,C=t.target.selectionStart||0;h(n);const m=n.slice(0,C);if(m.includes("{{")){const b=m.lastIndexOf("{{");m.slice(b+2).length>0||m.endsWith("{{")?(g.mutate({input:n,cursor_position:C,context:v}),y(!0),k(-1)):y(!1)}else y(!1)},[h,v,g]),B=u.useCallback(t=>{var C,m,T;if(!s||!((C=g.data)!=null&&C.suggestions.length)){if(t.ctrlKey&&t.key===" "){t.preventDefault();const b=((m=o.current)==null?void 0:m.value)||"",p=((T=o.current)==null?void 0:T.selectionStart)||0;g.mutate({input:b,cursor_position:p,context:v}),y(!0),k(-1)}return}const n=g.data.suggestions;switch(t.key){case"ArrowDown":t.preventDefault(),k(b=>(b+1)%n.length);break;case"ArrowUp":t.preventDefault(),k(b=>b<=0?n.length-1:b-1);break;case"Enter":case"Tab":d>=0&&(t.preventDefault(),O(n[d]));break;case"Escape":y(!1),k(-1);break}},[s,d,g.data,v,g,O]);u.useEffect(()=>{const t=n=>{w.current&&!w.current.contains(n.target)&&o.current&&!o.current.contains(n.target)&&(y(!1),k(-1))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const M=((F=g.data)==null?void 0:F.suggestions)||[];return e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:o,type:"text",value:i,onChange:U,onKeyDown:B,placeholder:L,className:j,disabled:E,autoComplete:"off",spellCheck:!1}),s&&M.length>0&&e.jsx("div",{ref:w,className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg max-h-60 overflow-y-auto",children:M.map((t,n)=>e.jsxs("div",{className:`px-3 py-2 cursor-pointer border-b border-gray-100 dark:border-gray-700 last:border-b-0 ${n===d?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,onClick:()=>O(t),children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.text}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t.kind==="variable"?"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300"}`,children:t.kind})]})}),t.documentation&&e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.documentation})]},`${t.kind}-${t.text}`))}),g.isPending&&s&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"Ctrl+Space"})]})}function R(i){if(!i)return"";const h=i.split(":");return h[h.length-1]||""}function K(i){if(!i)return!0;try{const h=new URL(i);return h.protocol==="http:"||h.protocol==="https:"}catch{return!1}}function H(i){return i>=1&&i<=65535}function la(){const[i,h]=u.useState("general"),{activeWorkspace:P}=je(),L=(P==null?void 0:P.id)||"default-workspace",[j,D]=u.useState(!1),[v,E]=u.useState(!1),{data:s,isLoading:y}=ve(),{data:d,isLoading:k}=ke(),{data:o,isLoading:w}=_e(),g=Ne(),O=we(),U=Ce(),B=Se(),M=Pe(),{data:F}=Ee(),[t,n]=u.useState({general:{http_port:3e3,ws_port:3001,grpc_port:50051,admin_port:9080},restartInProgress:!1,latency:{base_ms:0,jitter_ms:0},faults:{enabled:!1,failure_rate:0,status_codes:[]},trafficShaping:{enabled:!1,bandwidth:{enabled:!1,max_bytes_per_sec:1048576,burst_capacity_bytes:10485760},burstLoss:{enabled:!1,burst_probability:.1,burst_duration_ms:5e3,loss_rate_during_burst:.5,recovery_time_ms:3e4}},proxy:{enabled:!1,upstream_url:"",timeout_seconds:30},validation:{mode:"enforce",aggregate_errors:!0,validate_responses:!0,overrides:{}},protocols:{http:!0,graphql:!0,grpc:!0,websocket:!0,smtp:!1,mqtt:!1,ftp:!1,kafka:!1,rabbitmq:!1,amqp:!1},templateTest:""}),C=r=>{localStorage.setItem("mockforge_pending_port_config",JSON.stringify(r))};u.useEffect(()=>{const r=localStorage.getItem("mockforge_pending_port_config");if(r)try{const a=JSON.parse(r);n(l=>({...l,general:{...l.general,...a}}))}catch(a){G.error("Failed to parse pending port config",a),localStorage.removeItem("mockforge_pending_port_config")}},[]),u.useEffect(()=>{F&&t.restartInProgress&&(F.restarting||(n(r=>({...r,restartInProgress:!1})),c.success("Server restarted successfully! Port configuration applied."),localStorage.removeItem("mockforge_pending_port_config")))},[F,t.restartInProgress]),u.useEffect(()=>{s!=null&&s.latency&&n(r=>({...r,latency:{base_ms:s.latency.base_ms,jitter_ms:s.latency.jitter_ms}})),s!=null&&s.faults&&n(r=>({...r,faults:{enabled:s.faults.enabled,failure_rate:s.faults.failure_rate,status_codes:s.faults.status_codes}})),s!=null&&s.proxy&&n(r=>({...r,proxy:{enabled:s.proxy.enabled,upstream_url:s.proxy.upstream_url||"",timeout_seconds:s.proxy.timeout_seconds}}))},[s]),u.useEffect(()=>{o&&n(r=>({...r,general:{http_port:parseInt(R(o.http_server))||3e3,ws_port:parseInt(R(o.ws_server))||3001,grpc_port:parseInt(R(o.grpc_server))||50051,admin_port:o.admin_port||9080}}))},[o]),u.useEffect(()=>{d&&n(r=>({...r,validation:{mode:d.mode,aggregate_errors:d.aggregate_errors,validate_responses:d.validate_responses,overrides:d.overrides}}))},[d]),u.useEffect(()=>{let r=!1;if(o){const a=parseInt(R(o.http_server))||3e3,l=parseInt(R(o.ws_server))||3001,S=parseInt(R(o.grpc_server))||50051,N=o.admin_port||9080;(t.general.http_port!==a||t.general.ws_port!==l||t.general.grpc_port!==S||t.general.admin_port!==N)&&(r=!0)}s!=null&&s.latency&&(t.latency.base_ms!==s.latency.base_ms||t.latency.jitter_ms!==s.latency.jitter_ms)&&(r=!0),s!=null&&s.faults&&(t.faults.enabled!==s.faults.enabled||t.faults.failure_rate!==s.faults.failure_rate||JSON.stringify(t.faults.status_codes)!==JSON.stringify(s.faults.status_codes))&&(r=!0),s!=null&&s.proxy&&(t.proxy.enabled!==s.proxy.enabled||t.proxy.upstream_url!==(s.proxy.upstream_url||"")||t.proxy.timeout_seconds!==s.proxy.timeout_seconds)&&(r=!0),d&&(t.validation.mode!==d.mode||t.validation.aggregate_errors!==d.aggregate_errors||t.validation.validate_responses!==d.validate_responses)&&(r=!0),D(r)},[t,s,d,o]),u.useEffect(()=>{const r=a=>{j&&(a.preventDefault(),a.returnValue="")};return window.addEventListener("beforeunload",r),()=>window.removeEventListener("beforeunload",r)},[j]);const m=async r=>{if(r==="proxy"&&t.proxy.enabled){if(!t.proxy.upstream_url){c.error("Upstream URL is required when proxy is enabled");return}if(!K(t.proxy.upstream_url)){c.error("Invalid upstream URL. Must be a valid HTTP or HTTPS URL");return}if(!H(t.proxy.timeout_seconds)){c.error("Invalid timeout. Must be between 1 and 300 seconds");return}}if(r==="general"){if(!H(t.general.http_port)){c.error("Invalid HTTP port. Must be between 1 and 65535");return}if(!H(t.general.ws_port)){c.error("Invalid WebSocket port. Must be between 1 and 65535");return}if(!H(t.general.grpc_port)){c.error("Invalid gRPC port. Must be between 1 and 65535");return}if(!H(t.general.admin_port)){c.error("Invalid Admin port. Must be between 1 and 65535");return}}try{switch(r){case"latency":await g.mutateAsync({name:"default",base_ms:t.latency.base_ms,jitter_ms:t.latency.jitter_ms,tag_overrides:{}}),c.success("Latency configuration saved successfully");break;case"faults":await O.mutateAsync({enabled:t.faults.enabled,failure_rate:t.faults.failure_rate,status_codes:t.faults.status_codes,active_failures:0}),c.success("Fault injection configuration saved successfully");break;case"proxy":await U.mutateAsync({enabled:t.proxy.enabled,upstream_url:t.proxy.upstream_url,timeout_seconds:t.proxy.timeout_seconds,requests_proxied:0}),c.success("Proxy configuration saved successfully");break;case"validation":await B.mutateAsync({mode:t.validation.mode,aggregate_errors:t.validation.aggregate_errors,validate_responses:t.validation.validate_responses,overrides:t.validation.overrides}),c.success("Validation settings saved successfully");break;case"general":{C(t.general),E(!0);break}case"traffic-shaping":try{const a=await fetch("/__mockforge/config/traffic-shaping",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config_type:"traffic-shaping",data:t.trafficShaping})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);c.success("Traffic shaping configuration saved successfully")}catch(a){G.error("Error saving traffic shaping",a),c.error("Failed to save traffic shaping configuration")}break;default:c.error(`Unknown section: ${r}`)}}catch(a){G.error(`Error saving ${r} configuration:`,a),c.error(`Failed to save ${r} configuration`)}},T=async()=>{E(!1);try{n(r=>({...r,restartInProgress:!0})),c.info("Saving configuration and restarting server..."),await M.mutateAsync("Port configuration updated")}catch(r){n(a=>({...a,restartInProgress:!1})),c.error("Failed to restart server. Please restart manually."),G.error("Server restart failed",r)}},b=()=>{E(!1),c.info("Configuration saved locally. Restart the server manually to apply changes.")},p=r=>{switch(r){case"general":o&&(n(a=>({...a,general:{http_port:parseInt(R(o.http_server))||3e3,ws_port:parseInt(R(o.ws_server))||3001,grpc_port:parseInt(R(o.grpc_server))||50051,admin_port:o.admin_port||9080}})),c.info("General settings reset to server values"));break;case"latency":s!=null&&s.latency&&(n(a=>({...a,latency:{base_ms:s.latency.base_ms,jitter_ms:s.latency.jitter_ms}})),c.info("Latency configuration reset to server values"));break;case"faults":s!=null&&s.faults&&(n(a=>({...a,faults:{enabled:s.faults.enabled,failure_rate:s.faults.failure_rate,status_codes:s.faults.status_codes}})),c.info("Fault injection configuration reset to server values"));break;case"proxy":s!=null&&s.proxy&&(n(a=>({...a,proxy:{enabled:s.proxy.enabled,upstream_url:s.proxy.upstream_url||"",timeout_seconds:s.proxy.timeout_seconds}})),c.info("Proxy configuration reset to server values"));break;case"validation":d&&(n(a=>({...a,validation:{mode:d.mode,aggregate_errors:d.aggregate_errors,validate_responses:d.validate_responses,overrides:d.overrides}})),c.info("Validation settings reset to server values"));break;case"traffic-shaping":n(a=>({...a,trafficShaping:{enabled:!1,bandwidth:{enabled:!1,max_bytes_per_sec:1048576,burst_capacity_bytes:10485760},burstLoss:{enabled:!1,burst_probability:.1,burst_duration_ms:5e3,loss_rate_during_burst:.5,recovery_time_ms:3e4}}})),c.info("Traffic shaping configuration reset to defaults");break;default:c.error(`Unknown section: ${r}`)}},$=()=>{p("general"),p("latency"),p("faults"),p("traffic-shaping"),p("proxy"),p("validation"),c.success("All settings reset to server values")},V=async()=>{const r=["general","latency","faults","traffic-shaping","proxy","validation"];let a=0,l=0;for(const S of r)try{await m(S),a++}catch{l++}l===0?c.success("All settings saved successfully"):c.warning(`Saved ${a} sections, ${l} failed`)};if(y||k||w)return e.jsxs("div",{className:"space-y-8",children:[e.jsx(se,{title:"Configuration",subtitle:"Manage MockForge settings and preferences"}),e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-lg text-gray-600 dark:text-gray-400",children:"Loading configuration..."})]})]});const W=[{id:"general",label:"General",icon:te,description:"Basic MockForge settings"},{id:"protocols",label:"Protocols",icon:ne,description:"Protocol enable/disable settings"},{id:"latency",label:"Latency",icon:Ie,description:"Response delay and timing"},{id:"faults",label:"Fault Injection",icon:Ue,description:"Error simulation and failure modes"},{id:"traffic-shaping",label:"Traffic Shaping",icon:le,description:"Bandwidth control and network simulation"},{id:"proxy",label:"Proxy",icon:ne,description:"Upstream proxy configuration"},{id:"validation",label:"Validation",icon:Te,description:"Request/response validation"},{id:"environment",label:"Environment",icon:te,description:"Environment variables"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsx(se,{title:"Configuration",subtitle:j?"âš ï¸ You have unsaved changes":"Manage MockForge settings and preferences",action:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(x,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:$,children:[e.jsx(Q,{className:"h-4 w-4"}),"Reset All"]}),e.jsxs(x,{variant:"default",size:"sm",className:"flex items-center gap-2",onClick:V,children:[e.jsx(Ve,{className:"h-4 w-4"}),"Save All Changes"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(I,{children:e.jsx("nav",{className:"space-y-2",children:W.map(r=>{const a=r.icon;return e.jsxs("button",{onClick:()=>h(r.id),className:`w-full flex items-center gap-3 px-3 py-3 rounded-lg text-left transition-colors ${i===r.id?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"hover:bg-gray-50 dark:hover:bg-gray-800/50 text-gray-700 dark:text-gray-300"}`,children:[e.jsx(a,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.label}),e.jsx("div",{className:"text-xs opacity-75",children:r.description})]})]},r.id)})})})}),e.jsxs("div",{className:"lg:col-span-3",children:[i==="general"&&e.jsx(A,{title:"General Settings",subtitle:"Basic MockForge configuration",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Server Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"HTTP Port"}),e.jsx(f,{type:"number",min:"1",max:"65535",value:t.general.http_port,onChange:r=>n(a=>({...a,general:{...a.general,http_port:parseInt(r.target.value)||3e3}}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"WebSocket Port"}),e.jsx(f,{type:"number",min:"1",max:"65535",value:t.general.ws_port,onChange:r=>n(a=>({...a,general:{...a.general,ws_port:parseInt(r.target.value)||3001}}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"gRPC Port"}),e.jsx(f,{type:"number",min:"1",max:"65535",value:t.general.grpc_port,onChange:r=>n(a=>({...a,general:{...a.general,grpc_port:parseInt(r.target.value)||50051}}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Admin Port"}),e.jsx(f,{type:"number",min:"1",max:"65535",value:t.general.admin_port,onChange:r=>n(a=>({...a,general:{...a.general,admin_port:parseInt(r.target.value)||9080}}))})]})]})]}),t.restartInProgress&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg mb-4",children:[e.jsx(Q,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Server restart in progress... Configuration will be applied shortly."})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("general"),disabled:t.restartInProgress,children:"Reset"}),e.jsx(x,{onClick:()=>m("general"),disabled:t.restartInProgress,children:t.restartInProgress?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}),"Restarting..."]}):"Save & Restart Server"})]})]})})}),i==="protocols"&&e.jsx(A,{title:"Protocol Configuration",subtitle:"Enable or disable protocol support",children:e.jsx(I,{children:e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{key:"http",label:"HTTP/REST",description:"RESTful API mocking"},{key:"graphql",label:"GraphQL",description:"GraphQL API mocking"},{key:"grpc",label:"gRPC",description:"gRPC service mocking"},{key:"websocket",label:"WebSocket",description:"WebSocket connection mocking"},{key:"smtp",label:"SMTP",description:"Email protocol mocking"},{key:"mqtt",label:"MQTT",description:"IoT messaging protocol"},{key:"ftp",label:"FTP",description:"File transfer protocol"},{key:"kafka",label:"Kafka",description:"Event streaming platform"},{key:"rabbitmq",label:"RabbitMQ",description:"Message queuing system"},{key:"amqp",label:"AMQP",description:"Advanced message queuing"}].map(r=>{var a;return e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.label}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.description})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:((a=t.protocols)==null?void 0:a[r.key])??!1,onChange:l=>n(S=>({...S,protocols:{...S.protocols,[r.key]:l.target.checked}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]},r.key)})})})})}),i==="latency"&&e.jsx(A,{title:"Latency Configuration",subtitle:"Control response timing and delays",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Base Latency (ms)"}),e.jsx(f,{type:"number",placeholder:"0",value:t.latency.base_ms,onChange:r=>n(a=>({...a,latency:{...a.latency,base_ms:parseInt(r.target.value)||0}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Minimum response time for all requests"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Jitter (ms)"}),e.jsx(f,{type:"number",placeholder:"0",value:t.latency.jitter_ms,onChange:r=>n(a=>({...a,latency:{...a.latency,jitter_ms:parseInt(r.target.value)||0}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Random delay variation (Â± jitter)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("latency"),children:"Reset"}),e.jsx(x,{onClick:()=>m("latency"),children:"Save Changes"})]})]})})}),i==="faults"&&e.jsx(A,{title:"Fault Injection",subtitle:"Configure error simulation and failure scenarios",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Enable Fault Injection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Simulate network failures and server errors"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.faults.enabled,onChange:r=>n(a=>({...a,faults:{...a.faults,enabled:r.target.checked}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.faults.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Failure Rate (%)"}),e.jsx(f,{type:"number",min:"0",max:"100",placeholder:"5",value:t.faults.failure_rate,onChange:r=>n(a=>({...a,faults:{...a.faults,failure_rate:parseInt(r.target.value)||0}}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Error Status Codes"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[500,502,503,504,400,401,403,404].map(r=>e.jsx("button",{onClick:()=>{n(a=>({...a,faults:{...a.faults,status_codes:a.faults.status_codes.includes(r)?a.faults.status_codes.filter(l=>l!==r):[...a.faults.status_codes,r]}}))},className:"cursor-pointer",children:e.jsx(Re,{variant:t.faults.status_codes.includes(r)?"error":"outline",children:r})},r))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("faults"),children:"Reset"}),e.jsx(x,{onClick:()=>m("faults"),children:"Save Changes"})]})]})})}),i==="traffic-shaping"&&e.jsx(A,{title:"Traffic Shaping",subtitle:"Control bandwidth and simulate network conditions",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Enable Traffic Shaping"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Simulate real network conditions with bandwidth control and connectivity issues"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.trafficShaping.enabled,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,enabled:r.target.checked}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.trafficShaping.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(le,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Bandwidth Control"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Enable Bandwidth Throttling"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Limit data transfer rates using token bucket algorithm"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.trafficShaping.bandwidth.enabled,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,bandwidth:{...a.trafficShaping.bandwidth,enabled:r.target.checked}}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.trafficShaping.bandwidth.enabled&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Bandwidth (bytes/sec)"}),e.jsx(f,{type:"number",min:"1",placeholder:"1048576",value:t.trafficShaping.bandwidth.max_bytes_per_sec,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,bandwidth:{...a.trafficShaping.bandwidth,max_bytes_per_sec:parseInt(r.target.value)||1048576}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Maximum data transfer rate (1 MB/s = 1,048,576 bytes)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Burst Capacity (bytes)"}),e.jsx(f,{type:"number",min:"1",placeholder:"10485760",value:t.trafficShaping.bandwidth.burst_capacity_bytes,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,bandwidth:{...a.trafficShaping.bandwidth,burst_capacity_bytes:parseInt(r.target.value)||10485760}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Token bucket capacity for burst traffic (10 MB = 10,485,760 bytes)"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(He,{className:"h-5 w-5 text-orange-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Burst Loss Simulation"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Enable Burst Loss"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Simulate intermittent connectivity issues and packet loss"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.trafficShaping.burstLoss.enabled,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,burstLoss:{...a.trafficShaping.burstLoss,enabled:r.target.checked}}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.trafficShaping.burstLoss.enabled&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Burst Probability (%)"}),e.jsx(f,{type:"number",min:"0",max:"100",step:"0.1",placeholder:"10",value:t.trafficShaping.burstLoss.burst_probability*100,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,burstLoss:{...a.trafficShaping.burstLoss,burst_probability:parseFloat(r.target.value)/100||.1}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Probability of entering a loss burst (0-100%)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Burst Duration (ms)"}),e.jsx(f,{type:"number",min:"100",placeholder:"5000",value:t.trafficShaping.burstLoss.burst_duration_ms,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,burstLoss:{...a.trafficShaping.burstLoss,burst_duration_ms:parseInt(r.target.value)||5e3}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Duration of loss bursts in milliseconds"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Loss Rate During Burst (%)"}),e.jsx(f,{type:"number",min:"0",max:"100",step:"0.1",placeholder:"50",value:t.trafficShaping.burstLoss.loss_rate_during_burst*100,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,burstLoss:{...a.trafficShaping.burstLoss,loss_rate_during_burst:parseFloat(r.target.value)/100||.5}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Packet loss rate during burst periods (0-100%)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recovery Time (ms)"}),e.jsx(f,{type:"number",min:"1000",placeholder:"30000",value:t.trafficShaping.burstLoss.recovery_time_ms,onChange:r=>n(a=>({...a,trafficShaping:{...a.trafficShaping,burstLoss:{...a.trafficShaping.burstLoss,recovery_time_ms:parseInt(r.target.value)||3e4}}}))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Recovery period between bursts in milliseconds"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("traffic-shaping"),children:"Reset"}),e.jsx(x,{onClick:()=>m("traffic-shaping"),children:"Save Changes"})]})]})})}),i==="proxy"&&e.jsx(A,{title:"Proxy Configuration",subtitle:"Configure upstream proxy settings",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Enable Proxy Mode"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Forward requests to upstream services"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:t.proxy.enabled,onChange:r=>n(a=>({...a,proxy:{...a.proxy,enabled:r.target.checked}}))}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),t.proxy.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upstream URL"}),e.jsx(f,{type:"url",placeholder:"https://api.example.com",value:t.proxy.upstream_url,onChange:r=>n(a=>({...a,proxy:{...a.proxy,upstream_url:r.target.value}})),className:t.proxy.upstream_url&&!K(t.proxy.upstream_url)?"border-red-500 dark:border-red-500":""}),t.proxy.upstream_url&&!K(t.proxy.upstream_url)&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Must be a valid HTTP or HTTPS URL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeout (seconds)"}),e.jsx(f,{type:"number",min:"1",max:"300",placeholder:"30",value:t.proxy.timeout_seconds,onChange:r=>n(a=>({...a,proxy:{...a.proxy,timeout_seconds:parseInt(r.target.value)||30}}))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("proxy"),children:"Reset"}),e.jsx(x,{onClick:()=>m("proxy"),children:"Save Changes"})]})]})})}),i==="validation"&&e.jsx(A,{title:"Validation Settings",subtitle:"Configure request and response validation",children:e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Validation Mode"}),e.jsxs("select",{value:t.validation.mode,onChange:r=>n(a=>({...a,validation:{...a.validation,mode:r.target.value}})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"enforce",children:"Enforce (Strict)"}),e.jsx("option",{value:"warn",children:"Warn Only"}),e.jsx("option",{value:"off",children:"Disabled"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Aggregate Errors"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Collect all validation errors before responding"})]}),e.jsx("input",{type:"checkbox",checked:t.validation.aggregate_errors,onChange:r=>n(a=>({...a,validation:{...a.validation,aggregate_errors:r.target.checked}})),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Validate Responses"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Check response format and content"})]}),e.jsx("input",{type:"checkbox",checked:t.validation.validate_responses,onChange:r=>n(a=>({...a,validation:{...a.validation,validate_responses:r.target.checked}})),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(x,{variant:"outline",onClick:()=>p("validation"),children:"Reset"}),e.jsx(x,{onClick:()=>m("validation"),children:"Save Changes"})]})]})})}),i==="environment"&&e.jsxs(A,{title:"Environments & Variables",subtitle:"Manage environments and their variables",children:[e.jsx(ze,{workspaceId:L,onEnvironmentSelect:r=>{}}),e.jsx("div",{className:"mt-8",children:e.jsxs(I,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Template Testing"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Test variable substitution in templates. Type ","{{"," to see available variables."]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Template Input (with autocomplete)"}),e.jsx(Je,{value:t.templateTest||"",onChange:r=>n(a=>({...a,templateTest:r})),placeholder:"Type {{ to see available variables...",workspaceId:L,context:"template_test",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Expected Output"}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg font-mono text-sm text-gray-600 dark:text-gray-400",children:t.templateTest||"Template output will appear here..."})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ðŸ’¡ Tip: Use Ctrl+Space anywhere in a text input to manually trigger autocomplete"})]})]})})]})]})]}),e.jsx(Y,{open:v,onOpenChange:E,children:e.jsxs(Z,{children:[e.jsxs(X,{children:[e.jsx(ee,{children:"Restart Server Required"}),e.jsx(Le,{onClick:b})]}),e.jsx(De,{children:"Port configuration changes require a server restart to take effect."}),e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"HTTP Port:"}),e.jsx("span",{children:t.general.http_port})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"WebSocket Port:"}),e.jsx("span",{children:t.general.ws_port})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"gRPC Port:"}),e.jsx("span",{children:t.general.grpc_port})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Admin Port:"}),e.jsx("span",{children:t.general.admin_port})]})]})}),e.jsxs(ae,{children:[e.jsx(x,{variant:"outline",onClick:b,children:"Cancel"}),e.jsx(x,{onClick:T,children:"Restart Server"})]})]})})]})}export{la as ConfigPage};
